[0m12:54:03.317588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1192aaa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119272910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1192d5550>]}


============================== 12:54:03.320772 | 207cedc8-ec19-4af4-8faa-40e619448c5f ==============================
[0m12:54:03.320772 [info ] [MainThread]: Running with dbt=1.7.8
[0m12:54:03.321076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:54:03.416486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '207cedc8-ec19-4af4-8faa-40e619448c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119273710>]}
[0m12:54:03.449316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '207cedc8-ec19-4af4-8faa-40e619448c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1192734d0>]}
[0m12:54:03.449659 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m12:54:03.462952 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m12:54:03.528524 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:54:03.528776 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:54:03.531763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '207cedc8-ec19-4af4-8faa-40e619448c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1197119d0>]}
[0m12:54:03.539525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '207cedc8-ec19-4af4-8faa-40e619448c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119388bd0>]}
[0m12:54:03.539774 [info ] [MainThread]: Found 13 models, 8 sources, 0 exposures, 0 metrics, 423 macros, 0 groups, 0 semantic models
[0m12:54:03.539950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '207cedc8-ec19-4af4-8faa-40e619448c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1196e21d0>]}
[0m12:54:03.540664 [info ] [MainThread]: 
[0m12:54:03.541011 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m12:54:03.541482 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m12:54:03.547968 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m12:54:03.548150 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m12:54:03.548282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:04.370022 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m12:54:04.373688 [debug] [ThreadPool]: On list_iceberg: Close
[0m12:54:04.377796 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_landing)
[0m12:54:04.386691 [debug] [ThreadPool]: Using trino connection "list_iceberg_landing"
[0m12:54:04.387162 [debug] [ThreadPool]: On list_iceberg_landing: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg_landing"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'landing') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'landing'
[0m12:54:04.387471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:05.347819 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m12:54:05.354270 [debug] [ThreadPool]: On list_iceberg_landing: ROLLBACK
[0m12:54:05.356146 [debug] [ThreadPool]: On list_iceberg_landing: Close
[0m12:54:05.361843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '207cedc8-ec19-4af4-8faa-40e619448c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10128c390>]}
[0m12:54:05.362516 [debug] [MainThread]: On master: COMMIT
[0m12:54:05.363278 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:54:05.363655 [info ] [MainThread]: 
[0m12:54:05.371620 [debug] [Thread-1 (]: Began running node model.dev.stage_mssql_users
[0m12:54:05.372663 [info ] [Thread-1 (]: 1 of 1 START sql table model iceberg.landing.stage_mssql_users ................. [RUN]
[0m12:54:05.373421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_landing, now model.dev.stage_mssql_users)
[0m12:54:05.373733 [debug] [Thread-1 (]: Began compiling node model.dev.stage_mssql_users
[0m12:54:05.376906 [debug] [Thread-1 (]: Writing injected SQL for node "model.dev.stage_mssql_users"
[0m12:54:05.380392 [debug] [Thread-1 (]: Timing info for model.dev.stage_mssql_users (compile): 12:54:05.373945 => 12:54:05.380190
[0m12:54:05.380686 [debug] [Thread-1 (]: Began executing node model.dev.stage_mssql_users
[0m12:54:05.405220 [debug] [Thread-1 (]: Writing runtime sql for node "model.dev.stage_mssql_users"
[0m12:54:05.410183 [debug] [Thread-1 (]: Using trino connection "model.dev.stage_mssql_users"
[0m12:54:05.410439 [debug] [Thread-1 (]: On model.dev.stage_mssql_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.stage_mssql_users"} */

  
    

    create table "iceberg"."landing"."stage_mssql_users__dbt_tmp"
      
      
    as (
      

SELECT DISTINCT
    CAST(user_id AS INT) AS user_id,
    cpf AS cpf,
    CONCAT(first_name, ' ', last_name) AS full_name,
    CAST(date_birth AS DATE) AS date_of_birth,
    city AS city,
    country AS country,
    company_name AS company_name,
    job AS job,
    phone_number AS phone_number,
    time_zone AS time_zone,
    CAST(dt_current_timestamp AS TIMESTAMP) AS last_updated
FROM "minio"."landing"."mssql_users_parquet"
    )
[0m12:54:05.410646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:08.558129 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m12:54:08.564399 [debug] [Thread-1 (]: Using trino connection "model.dev.stage_mssql_users"
[0m12:54:08.564736 [debug] [Thread-1 (]: On model.dev.stage_mssql_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.stage_mssql_users"} */
alter table "iceberg"."landing"."stage_mssql_users" rename to "iceberg"."landing"."stage_mssql_users__dbt_backup"
[0m12:54:09.115582 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m12:54:09.122940 [debug] [Thread-1 (]: Using trino connection "model.dev.stage_mssql_users"
[0m12:54:09.123739 [debug] [Thread-1 (]: On model.dev.stage_mssql_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.stage_mssql_users"} */
alter table "iceberg"."landing"."stage_mssql_users__dbt_tmp" rename to "iceberg"."landing"."stage_mssql_users"
[0m12:54:09.661982 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m12:54:09.670175 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."landing"."stage_mssql_users__dbt_backup"
[0m12:54:09.672841 [debug] [Thread-1 (]: Using trino connection "model.dev.stage_mssql_users"
[0m12:54:09.673384 [debug] [Thread-1 (]: On model.dev.stage_mssql_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.stage_mssql_users"} */

    drop table if exists "iceberg"."landing"."stage_mssql_users__dbt_backup"
[0m12:54:10.215693 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m12:54:10.223893 [debug] [Thread-1 (]: Timing info for model.dev.stage_mssql_users (execute): 12:54:05.380851 => 12:54:10.223778
[0m12:54:10.224125 [debug] [Thread-1 (]: On model.dev.stage_mssql_users: ROLLBACK
[0m12:54:10.224285 [debug] [Thread-1 (]: On model.dev.stage_mssql_users: Close
[0m12:54:10.224780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '207cedc8-ec19-4af4-8faa-40e619448c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1197c7090>]}
[0m12:54:10.225094 [info ] [Thread-1 (]: 1 of 1 OK created sql table model iceberg.landing.stage_mssql_users ............ [[32mSUCCESS[0m in 4.85s]
[0m12:54:10.225367 [debug] [Thread-1 (]: Finished running node model.dev.stage_mssql_users
[0m12:54:10.226140 [debug] [MainThread]: On master: COMMIT
[0m12:54:10.226467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:10.226607 [debug] [MainThread]: Connection 'model.dev.stage_mssql_users' was properly closed.
[0m12:54:10.226766 [info ] [MainThread]: 
[0m12:54:10.226923 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.69 seconds (6.69s).
[0m12:54:10.227218 [debug] [MainThread]: Command end result
[0m12:54:10.235793 [info ] [MainThread]: 
[0m12:54:10.236031 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:54:10.236194 [info ] [MainThread]: 
[0m12:54:10.236356 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:54:10.247006 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.9870834, "process_user_time": 1.039752, "process_kernel_time": 0.213528, "process_mem_max_rss": "117981184", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:54:10.247340 [debug] [MainThread]: Command `cli run` succeeded at 12:54:10.247279 after 6.99 seconds
[0m12:54:10.247566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1192d6f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1192d7090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119257950>]}
[0m12:54:10.247753 [debug] [MainThread]: Flushing usage events
[0m14:53:43.255489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e74f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c397e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3da7c0>]}


============================== 14:53:43.258766 | 732a1da5-c18f-46f7-a8a6-d37e37cd41d2 ==============================
[0m14:53:43.258766 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:53:43.259096 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'version_check': 'True', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt parse', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:53:43.381475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '732a1da5-c18f-46f7-a8a6-d37e37cd41d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3af4f0>]}
[0m14:53:43.422735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '732a1da5-c18f-46f7-a8a6-d37e37cd41d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6039a0>]}
[0m14:53:43.423049 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m14:53:43.434375 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m14:53:43.488255 [debug] [MainThread]: Partial parsing enabled: 13 files deleted, 8 files added, 0 files changed.
[0m14:53:43.488715 [debug] [MainThread]: Partial parsing: added file: dev://models/stage/postgres_subscription.sql
[0m14:53:43.488952 [debug] [MainThread]: Partial parsing: added file: dev://models/stage/mssql_users.sql
[0m14:53:43.492699 [debug] [MainThread]: Partial parsing: added file: dev://models/stage/postgres_payments.sql
[0m14:53:43.493331 [debug] [MainThread]: Partial parsing: added file: dev://models/stage/mssql_credit_card.sql
[0m14:53:43.493506 [debug] [MainThread]: Partial parsing: added file: dev://models/stage/mongodb_users.sql
[0m14:53:43.497668 [debug] [MainThread]: Partial parsing: added file: dev://models/stage/postgres_vehicle.sql
[0m14:53:43.497858 [debug] [MainThread]: Partial parsing: added file: dev://models/stage/mongodb_stripe.sql
[0m14:53:43.498034 [debug] [MainThread]: Partial parsing: added file: dev://models/stage/mongodb_rides.sql
[0m14:53:43.498224 [debug] [MainThread]: Partial parsing: deleted file: dev://models/stage/stage_mongodb_users.sql
[0m14:53:43.501642 [debug] [MainThread]: Partial parsing: deleted file: dev://models/stage/stage_postgres_vehicle.sql
[0m14:53:43.501882 [debug] [MainThread]: Partial parsing: deleted file: dev://models/trusted/trusted_most_used_payment_methods.sql
[0m14:53:43.502071 [debug] [MainThread]: Partial parsing: deleted file: dev://models/stage/stage_postgres_subscription.sql
[0m14:53:43.502264 [debug] [MainThread]: Partial parsing: deleted file: dev://models/stage/stage_postgres_payments.sql
[0m14:53:43.505727 [debug] [MainThread]: Partial parsing: deleted file: dev://models/stage/stage_mongodb_rides.sql
[0m14:53:43.505897 [debug] [MainThread]: Partial parsing: deleted file: dev://models/stage/stage_mongodb_stripe.sql
[0m14:53:43.506051 [debug] [MainThread]: Partial parsing: deleted file: dev://models/stage/stage_mssql_users.sql
[0m14:53:43.506203 [debug] [MainThread]: Partial parsing: deleted file: dev://models/trusted/trusted_top_vehicles.sql
[0m14:53:43.506354 [debug] [MainThread]: Partial parsing: deleted file: dev://models/trusted/trusted_total_transactions_per_country.sql
[0m14:53:43.506503 [debug] [MainThread]: Partial parsing: deleted file: dev://models/trusted/trusted_users.sql
[0m14:53:43.506654 [debug] [MainThread]: Partial parsing: deleted file: dev://models/trusted/trusted_ride_transactions.sql
[0m14:53:43.506802 [debug] [MainThread]: Partial parsing: deleted file: dev://models/stage/stage_mssql_credit_card.sql
[0m14:53:43.606829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '732a1da5-c18f-46f7-a8a6-d37e37cd41d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9def40>]}
[0m14:53:43.607798 [info ] [MainThread]: Performance info: /Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/target/perf_info.json
[0m14:53:43.626403 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 0.4116587, "process_user_time": 1.249101, "process_kernel_time": 0.173951, "process_mem_max_rss": "110952448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:53:43.626727 [debug] [MainThread]: Command `dbt parse` succeeded at 14:53:43.626659 after 0.41 seconds
[0m14:53:43.626929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e74f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6bf430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c719730>]}
[0m14:53:43.627120 [debug] [MainThread]: Flushing usage events
[0m14:54:00.413867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c3b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10497dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10498ed30>]}


============================== 14:54:00.416344 | 4efbfb0c-dff8-44a1-9410-b3a94d9ccd37 ==============================
[0m14:54:00.416344 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:54:00.416684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt parse', 'send_anonymous_usage_stats': 'True'}
[0m14:54:00.535825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4efbfb0c-dff8-44a1-9410-b3a94d9ccd37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10494bbe0>]}
[0m14:54:00.576978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4efbfb0c-dff8-44a1-9410-b3a94d9ccd37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c84970>]}
[0m14:54:00.577270 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m14:54:00.589362 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m14:54:00.591163 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:54:00.591417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4efbfb0c-dff8-44a1-9410-b3a94d9ccd37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c84b80>]}
[0m14:54:01.180812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4efbfb0c-dff8-44a1-9410-b3a94d9ccd37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa50d0>]}
[0m14:54:01.181495 [info ] [MainThread]: Performance info: /Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/target/perf_info.json
[0m14:54:01.187467 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 0.80951804, "process_user_time": 1.72833, "process_kernel_time": 0.166584, "process_mem_max_rss": "113917952", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:54:01.187748 [debug] [MainThread]: Command `dbt parse` succeeded at 14:54:01.187683 after 0.81 seconds
[0m14:54:01.187953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c3b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc8d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059d4e80>]}
[0m14:54:01.188169 [debug] [MainThread]: Flushing usage events
[0m16:44:26.168129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103076b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050dc850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050bfe80>]}


============================== 16:44:26.170872 | 4a1b4bbc-ee31-4e79-92be-e1358fbc66e0 ==============================
[0m16:44:26.170872 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:44:26.171190 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:44:26.293832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a1b4bbc-ee31-4e79-92be-e1358fbc66e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050dc850>]}
[0m16:44:26.334710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a1b4bbc-ee31-4e79-92be-e1358fbc66e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052c7370>]}
[0m16:44:26.335029 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:44:26.346058 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m16:44:26.398989 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:44:26.399289 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:44:26.399836 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.owshq.users
[0m16:44:26.402946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a1b4bbc-ee31-4e79-92be-e1358fbc66e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056c6fd0>]}
[0m16:44:26.410118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a1b4bbc-ee31-4e79-92be-e1358fbc66e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054f07c0>]}
[0m16:44:26.410503 [info ] [MainThread]: Found 9 models, 8 sources, 0 exposures, 0 metrics, 423 macros, 0 groups, 0 semantic models
[0m16:44:26.410721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a1b4bbc-ee31-4e79-92be-e1358fbc66e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054f07f0>]}
[0m16:44:26.411674 [info ] [MainThread]: 
[0m16:44:26.412098 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:44:26.412705 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m16:44:26.421845 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m16:44:26.422059 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m16:44:26.422229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:27.250546 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:44:27.252096 [debug] [ThreadPool]: On list_iceberg: Close
[0m16:44:27.253290 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now create_iceberg_landing_stage)
[0m16:44:27.253853 [debug] [ThreadPool]: Creating schema "database: "iceberg"
schema: "landing_stage"
"
[0m16:44:27.258550 [debug] [ThreadPool]: Using trino connection "create_iceberg_landing_stage"
[0m16:44:27.258826 [debug] [ThreadPool]: On create_iceberg_landing_stage: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "create_iceberg_landing_stage"} */
create schema if not exists "iceberg"."landing_stage"
[0m16:44:27.259073 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:27.940177 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:44:27.943948 [debug] [ThreadPool]: On create_iceberg_landing_stage: COMMIT
[0m16:44:27.944814 [debug] [ThreadPool]: On create_iceberg_landing_stage: Close
[0m16:44:27.949111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_iceberg_landing_stage, now list_iceberg_landing_stage)
[0m16:44:27.958933 [debug] [ThreadPool]: Using trino connection "list_iceberg_landing_stage"
[0m16:44:27.959398 [debug] [ThreadPool]: On list_iceberg_landing_stage: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg_landing_stage"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'landing_stage') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'landing_stage'
[0m16:44:27.959967 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:29.154331 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:44:29.158001 [debug] [ThreadPool]: On list_iceberg_landing_stage: ROLLBACK
[0m16:44:29.158745 [debug] [ThreadPool]: On list_iceberg_landing_stage: Close
[0m16:44:29.161216 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_landing_stage, now list_iceberg_landing)
[0m16:44:29.168384 [debug] [ThreadPool]: Using trino connection "list_iceberg_landing"
[0m16:44:29.168953 [debug] [ThreadPool]: On list_iceberg_landing: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg_landing"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'landing') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'landing'
[0m16:44:29.169360 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:30.513610 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:44:30.517222 [debug] [ThreadPool]: On list_iceberg_landing: ROLLBACK
[0m16:44:30.517973 [debug] [ThreadPool]: On list_iceberg_landing: Close
[0m16:44:30.523783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a1b4bbc-ee31-4e79-92be-e1358fbc66e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051f6790>]}
[0m16:44:30.524454 [debug] [MainThread]: On master: COMMIT
[0m16:44:30.525354 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:44:30.525805 [info ] [MainThread]: 
[0m16:44:30.535398 [debug] [Thread-1  ]: Began running node model.dev.mssql_users
[0m16:44:30.536032 [info ] [Thread-1  ]: 1 of 1 START sql table model iceberg.landing_stage.mssql_users ................. [RUN]
[0m16:44:30.536886 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_landing, now model.dev.mssql_users)
[0m16:44:30.537330 [debug] [Thread-1  ]: Began compiling node model.dev.mssql_users
[0m16:44:30.541565 [debug] [Thread-1  ]: Writing injected SQL for node "model.dev.mssql_users"
[0m16:44:30.544883 [debug] [Thread-1  ]: Timing info for model.dev.mssql_users (compile): 16:44:30.537571 => 16:44:30.544628
[0m16:44:30.545268 [debug] [Thread-1  ]: Began executing node model.dev.mssql_users
[0m16:44:30.575209 [debug] [Thread-1  ]: Writing runtime sql for node "model.dev.mssql_users"
[0m16:44:30.578577 [debug] [Thread-1  ]: Using trino connection "model.dev.mssql_users"
[0m16:44:30.578841 [debug] [Thread-1  ]: On model.dev.mssql_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mssql_users"} */

  
    

    create table "iceberg"."landing_stage"."mssql_users__dbt_tmp"
      
      
    as (
      

SELECT DISTINCT
    CAST(user_id AS INT) AS user_id,
    cpf AS cpf,
    CONCAT(first_name, ' ', last_name) AS full_name,
    CAST(date_birth AS DATE) AS date_of_birth,
    city AS city,
    country AS country,
    company_name AS company_name,
    job AS job,
    phone_number AS phone_number,
    time_zone AS time_zone,
    CAST(dt_current_timestamp AS TIMESTAMP) AS last_updated
FROM "minio"."landing"."mssql_users_parquet"
    )
[0m16:44:30.579091 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:44:33.488242 [debug] [Thread-1  ]: SQL status: SUCCESS in 3.0 seconds
[0m16:44:33.520474 [debug] [Thread-1  ]: Using trino connection "model.dev.mssql_users"
[0m16:44:33.520830 [debug] [Thread-1  ]: On model.dev.mssql_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mssql_users"} */
alter table "iceberg"."landing_stage"."mssql_users__dbt_tmp" rename to "iceberg"."landing_stage"."mssql_users"
[0m16:44:34.068563 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:44:34.083837 [debug] [Thread-1  ]: Applying DROP to: "iceberg"."landing_stage"."mssql_users__dbt_backup"
[0m16:44:34.086089 [debug] [Thread-1  ]: Using trino connection "model.dev.mssql_users"
[0m16:44:34.086538 [debug] [Thread-1  ]: On model.dev.mssql_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mssql_users"} */

    drop table if exists "iceberg"."landing_stage"."mssql_users__dbt_backup"
[0m16:44:34.631682 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:44:34.653916 [debug] [Thread-1  ]: Timing info for model.dev.mssql_users (execute): 16:44:30.545464 => 16:44:34.653664
[0m16:44:34.654433 [debug] [Thread-1  ]: On model.dev.mssql_users: ROLLBACK
[0m16:44:34.654801 [debug] [Thread-1  ]: On model.dev.mssql_users: Close
[0m16:44:34.655611 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a1b4bbc-ee31-4e79-92be-e1358fbc66e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057dd580>]}
[0m16:44:34.656141 [info ] [Thread-1  ]: 1 of 1 OK created sql table model iceberg.landing_stage.mssql_users ............ [[32mSUCCESS[0m in 4.12s]
[0m16:44:34.656660 [debug] [Thread-1  ]: Finished running node model.dev.mssql_users
[0m16:44:34.657803 [debug] [MainThread]: On master: COMMIT
[0m16:44:34.658360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:34.658631 [debug] [MainThread]: Connection 'model.dev.mssql_users' was properly closed.
[0m16:44:34.658917 [info ] [MainThread]: 
[0m16:44:34.659238 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.25 seconds (8.25s).
[0m16:44:34.659800 [debug] [MainThread]: Command end result
[0m16:44:34.668515 [info ] [MainThread]: 
[0m16:44:34.668815 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:44:34.669067 [info ] [MainThread]: 
[0m16:44:34.669332 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:44:34.672351 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.546445, "process_user_time": 1.48141, "process_kernel_time": 0.169821, "process_mem_max_rss": "113197056", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:44:34.672817 [debug] [MainThread]: Command `cli run` succeeded at 16:44:34.672711 after 8.55 seconds
[0m16:44:34.673115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103076b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105816280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052c7370>]}
[0m16:44:34.673412 [debug] [MainThread]: Flushing usage events
[0m16:47:31.086793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102de4160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b759a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bb4550>]}


============================== 16:47:31.089994 | e3152b95-2da8-4277-9512-afe74436081d ==============================
[0m16:47:31.089994 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:47:31.090294 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:47:31.214357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3152b95-2da8-4277-9512-afe74436081d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ce2250>]}
[0m16:47:31.255602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3152b95-2da8-4277-9512-afe74436081d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dd4ee0>]}
[0m16:47:31.255943 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:47:31.266535 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m16:47:31.317844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:47:31.318125 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:47:31.318661 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.owshq.users
[0m16:47:31.322201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3152b95-2da8-4277-9512-afe74436081d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10509ff70>]}
[0m16:47:31.328446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3152b95-2da8-4277-9512-afe74436081d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc8760>]}
[0m16:47:31.328718 [info ] [MainThread]: Found 9 models, 8 sources, 0 exposures, 0 metrics, 423 macros, 0 groups, 0 semantic models
[0m16:47:31.328939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3152b95-2da8-4277-9512-afe74436081d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc89d0>]}
[0m16:47:31.329595 [info ] [MainThread]: 
[0m16:47:31.329785 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:47:31.330047 [debug] [MainThread]: Command end result
[0m16:47:31.343820 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.29616874, "process_user_time": 1.175207, "process_kernel_time": 0.172041, "process_mem_max_rss": "106692608", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:47:31.344185 [debug] [MainThread]: Command `cli test` succeeded at 16:47:31.344115 after 0.30 seconds
[0m16:47:31.344391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102de4160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d84190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e52910>]}
[0m16:47:31.344600 [debug] [MainThread]: Flushing usage events
[0m16:47:50.217884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107838dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1199c3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119a1cf10>]}


============================== 16:47:50.220852 | e4bd760b-c104-4767-9815-8b05406e5e8b ==============================
[0m16:47:50.220852 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:47:50.221226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:47:50.341745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4bd760b-c104-4767-9815-8b05406e5e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1199b5fd0>]}
[0m16:47:50.383596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4bd760b-c104-4767-9815-8b05406e5e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119d23730>]}
[0m16:47:50.383926 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:47:50.396275 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m16:47:50.448287 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:47:50.448553 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:47:50.452211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4bd760b-c104-4767-9815-8b05406e5e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a803f40>]}
[0m16:47:50.460140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4bd760b-c104-4767-9815-8b05406e5e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119e2a730>]}
[0m16:47:50.460417 [info ] [MainThread]: Found 9 models, 8 sources, 0 exposures, 0 metrics, 423 macros, 0 groups, 0 semantic models
[0m16:47:50.460628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4bd760b-c104-4767-9815-8b05406e5e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119e2a9a0>]}
[0m16:47:50.461350 [info ] [MainThread]: 
[0m16:47:50.461759 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:47:50.462283 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m16:47:50.471185 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m16:47:50.471406 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m16:47:50.471608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:51.437912 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:47:51.439399 [debug] [ThreadPool]: On list_iceberg: Close
[0m16:47:51.441299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_landing)
[0m16:47:51.448836 [debug] [ThreadPool]: Using trino connection "list_iceberg_landing"
[0m16:47:51.449155 [debug] [ThreadPool]: On list_iceberg_landing: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg_landing"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'landing') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'landing'
[0m16:47:51.449433 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:47:52.418518 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:47:52.422330 [debug] [ThreadPool]: On list_iceberg_landing: ROLLBACK
[0m16:47:52.422911 [debug] [ThreadPool]: On list_iceberg_landing: Close
[0m16:47:52.427132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4bd760b-c104-4767-9815-8b05406e5e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c64850>]}
[0m16:47:52.427875 [debug] [MainThread]: On master: COMMIT
[0m16:47:52.428690 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:47:52.429077 [info ] [MainThread]: 
[0m16:47:52.433892 [debug] [Thread-1  ]: Began running node model.dev.mongodb_rides
[0m16:47:52.434397 [info ] [Thread-1  ]: 1 of 1 START sql table model iceberg.landing.mongodb_rides ..................... [RUN]
[0m16:47:52.435101 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_landing, now model.dev.mongodb_rides)
[0m16:47:52.435502 [debug] [Thread-1  ]: Began compiling node model.dev.mongodb_rides
[0m16:47:52.440610 [debug] [Thread-1  ]: Writing injected SQL for node "model.dev.mongodb_rides"
[0m16:47:52.441744 [debug] [Thread-1  ]: Timing info for model.dev.mongodb_rides (compile): 16:47:52.435748 => 16:47:52.441536
[0m16:47:52.442071 [debug] [Thread-1  ]: Began executing node model.dev.mongodb_rides
[0m16:47:52.469645 [debug] [Thread-1  ]: Writing runtime sql for node "model.dev.mongodb_rides"
[0m16:47:52.472569 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_rides"
[0m16:47:52.472856 [debug] [Thread-1  ]: On model.dev.mongodb_rides: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_rides"} */

  
    

    create table "iceberg"."landing"."mongodb_rides__dbt_tmp"
      
      
    as (
      

SELECT 
    
    CAST(FLOOR(random() * (10000 - 1 + 1)) + 1 AS INTEGER)
 AS ride_id,
    CAST(user_id AS INT) AS user_id,
    cpf AS cpf,
    CAST(vehicle_id AS INT) AS vehicle_id,
    
    CAST(FLOOR(random() * (10000 - 1 + 1)) + 1 AS INTEGER)
 AS subscription_id,
    
    CAST(FLOOR(random() * (10000 - 1 + 1)) + 1 AS INTEGER)
 AS payment_id,
    
    CAST(FLOOR(random() * (10000 - 1 + 1)) + 1 AS INTEGER)
 AS stripe_id,
    source AS source,
    destination AS destination,
    CAST(price AS REAL) AS estimated_price,
    surge_multiplier AS surge_multiplier,
    CASE WHEN surge_multiplier <> 1 THEN CAST(price AS REAL) * surge_multiplier ELSE CAST(price AS REAL) END AS price,
    name AS car_type,
    cab_type AS service_type,
    CAST(dt_current_timestamp AS TIMESTAMP) AS last_updated
FROM "minio"."landing"."mongodb_rides_parquet"
    )
[0m16:47:52.473112 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:47:54.710924 [debug] [Thread-1  ]: SQL status: SUCCESS in 2.0 seconds
[0m16:47:54.725705 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_rides"
[0m16:47:54.726343 [debug] [Thread-1  ]: On model.dev.mongodb_rides: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_rides"} */
alter table "iceberg"."landing"."mongodb_rides__dbt_tmp" rename to "iceberg"."landing"."mongodb_rides"
[0m16:47:55.284598 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:47:55.336276 [debug] [Thread-1  ]: Applying DROP to: "iceberg"."landing"."mongodb_rides__dbt_backup"
[0m16:47:55.337679 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_rides"
[0m16:47:55.337962 [debug] [Thread-1  ]: On model.dev.mongodb_rides: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_rides"} */

    drop table if exists "iceberg"."landing"."mongodb_rides__dbt_backup"
[0m16:47:55.884237 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:47:55.905589 [debug] [Thread-1  ]: Timing info for model.dev.mongodb_rides (execute): 16:47:52.442263 => 16:47:55.905351
[0m16:47:55.906063 [debug] [Thread-1  ]: On model.dev.mongodb_rides: ROLLBACK
[0m16:47:55.906390 [debug] [Thread-1  ]: On model.dev.mongodb_rides: Close
[0m16:47:55.907295 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4bd760b-c104-4767-9815-8b05406e5e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a8a5b80>]}
[0m16:47:55.907877 [info ] [Thread-1  ]: 1 of 1 OK created sql table model iceberg.landing.mongodb_rides ................ [[32mSUCCESS[0m in 3.47s]
[0m16:47:55.908414 [debug] [Thread-1  ]: Finished running node model.dev.mongodb_rides
[0m16:47:55.909509 [debug] [MainThread]: On master: COMMIT
[0m16:47:55.910108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:55.910394 [debug] [MainThread]: Connection 'model.dev.mongodb_rides' was properly closed.
[0m16:47:55.910686 [info ] [MainThread]: 
[0m16:47:55.911007 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.45 seconds (5.45s).
[0m16:47:55.911574 [debug] [MainThread]: Command end result
[0m16:47:55.919706 [info ] [MainThread]: 
[0m16:47:55.920023 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:47:55.920294 [info ] [MainThread]: 
[0m16:47:55.920579 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:47:55.923468 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.740779, "process_user_time": 1.447739, "process_kernel_time": 0.175274, "process_mem_max_rss": "111902720", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:47:55.923842 [debug] [MainThread]: Command `cli run` succeeded at 16:47:55.923742 after 5.74 seconds
[0m16:47:55.924132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107838dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c1df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1199b5fd0>]}
[0m16:47:55.924431 [debug] [MainThread]: Flushing usage events
[0m16:49:33.250079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e84f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10779da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077dca90>]}


============================== 16:49:33.252577 | 41e7fbda-4998-4558-a9bb-4808c8647478 ==============================
[0m16:49:33.252577 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:49:33.252893 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m16:49:33.370275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41e7fbda-4998-4558-a9bb-4808c8647478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f9310>]}
[0m16:49:33.411976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41e7fbda-4998-4558-a9bb-4808c8647478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f31c0>]}
[0m16:49:33.412375 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:49:33.421937 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m16:49:33.470635 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:49:33.470990 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:49:33.474801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41e7fbda-4998-4558-a9bb-4808c8647478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc3f10>]}
[0m16:49:33.480589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41e7fbda-4998-4558-a9bb-4808c8647478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bed700>]}
[0m16:49:33.480833 [info ] [MainThread]: Found 9 models, 8 sources, 0 exposures, 0 metrics, 423 macros, 0 groups, 0 semantic models
[0m16:49:33.481047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41e7fbda-4998-4558-a9bb-4808c8647478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bed970>]}
[0m16:49:33.481731 [info ] [MainThread]: 
[0m16:49:33.482111 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:49:33.482612 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m16:49:33.491297 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m16:49:33.491520 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m16:49:33.491690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:34.444647 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:49:34.448283 [debug] [ThreadPool]: On list_iceberg: Close
[0m16:49:34.452533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_landing)
[0m16:49:34.463173 [debug] [ThreadPool]: Using trino connection "list_iceberg_landing"
[0m16:49:34.463699 [debug] [ThreadPool]: On list_iceberg_landing: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg_landing"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'landing') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'landing'
[0m16:49:34.464079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:35.420557 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:49:35.423767 [debug] [ThreadPool]: On list_iceberg_landing: ROLLBACK
[0m16:49:35.424477 [debug] [ThreadPool]: On list_iceberg_landing: Close
[0m16:49:35.429182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41e7fbda-4998-4558-a9bb-4808c8647478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bed460>]}
[0m16:49:35.430045 [debug] [MainThread]: On master: COMMIT
[0m16:49:35.431205 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:49:35.431822 [info ] [MainThread]: 
[0m16:49:35.435079 [debug] [Thread-1  ]: Began running node model.dev.mongodb_rides
[0m16:49:35.435764 [info ] [Thread-1  ]: 1 of 1 START sql table model iceberg.landing.mongodb_rides ..................... [RUN]
[0m16:49:35.436630 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_landing, now model.dev.mongodb_rides)
[0m16:49:35.437042 [debug] [Thread-1  ]: Began compiling node model.dev.mongodb_rides
[0m16:49:35.442609 [debug] [Thread-1  ]: Writing injected SQL for node "model.dev.mongodb_rides"
[0m16:49:35.444467 [debug] [Thread-1  ]: Timing info for model.dev.mongodb_rides (compile): 16:49:35.437317 => 16:49:35.444213
[0m16:49:35.444870 [debug] [Thread-1  ]: Began executing node model.dev.mongodb_rides
[0m16:49:35.475243 [debug] [Thread-1  ]: Writing runtime sql for node "model.dev.mongodb_rides"
[0m16:49:35.478417 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_rides"
[0m16:49:35.478708 [debug] [Thread-1  ]: On model.dev.mongodb_rides: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_rides"} */

  
    

    create table "iceberg"."landing"."mongodb_rides__dbt_tmp"
      
      
    as (
      

SELECT 
    
    CAST(FLOOR(random() * (10000 - 1 + 1)) + 1 AS INTEGER)
 AS ride_id,
    CAST(user_id AS INT) AS user_id,
    cpf AS cpf,
    CAST(vehicle_id AS INT) AS vehicle_id,
    
    CAST(FLOOR(random() * (10000 - 1 + 1)) + 1 AS INTEGER)
 AS subscription_id,
    
    CAST(FLOOR(random() * (10000 - 1 + 1)) + 1 AS INTEGER)
 AS payment_id,
    
    CAST(FLOOR(random() * (10000 - 1 + 1)) + 1 AS INTEGER)
 AS stripe_id,
    source AS source,
    destination AS destination,
    CAST(price AS REAL) AS estimated_price,
    surge_multiplier AS surge_multiplier,
    CASE WHEN surge_multiplier <> 1 THEN CAST(price AS REAL) * surge_multiplier ELSE CAST(price AS REAL) END AS price,
    name AS car_type,
    cab_type AS service_type,
    CAST(dt_current_timestamp AS TIMESTAMP) AS last_updated
FROM "minio"."landing"."mongodb_rides_parquet"
    )
[0m16:49:35.478976 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:49:37.664613 [debug] [Thread-1  ]: SQL status: SUCCESS in 2.0 seconds
[0m16:49:37.679233 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_rides"
[0m16:49:37.679821 [debug] [Thread-1  ]: On model.dev.mongodb_rides: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_rides"} */
alter table "iceberg"."landing"."mongodb_rides" rename to "iceberg"."landing"."mongodb_rides__dbt_backup"
[0m16:49:38.243654 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:49:38.250567 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_rides"
[0m16:49:38.251032 [debug] [Thread-1  ]: On model.dev.mongodb_rides: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_rides"} */
alter table "iceberg"."landing"."mongodb_rides__dbt_tmp" rename to "iceberg"."landing"."mongodb_rides"
[0m16:49:38.801237 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:49:38.853835 [debug] [Thread-1  ]: Applying DROP to: "iceberg"."landing"."mongodb_rides__dbt_backup"
[0m16:49:38.855332 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_rides"
[0m16:49:38.855636 [debug] [Thread-1  ]: On model.dev.mongodb_rides: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_rides"} */

    drop table if exists "iceberg"."landing"."mongodb_rides__dbt_backup"
[0m16:49:39.404049 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:49:39.428691 [debug] [Thread-1  ]: Timing info for model.dev.mongodb_rides (execute): 16:49:35.445102 => 16:49:39.428461
[0m16:49:39.429146 [debug] [Thread-1  ]: On model.dev.mongodb_rides: ROLLBACK
[0m16:49:39.429476 [debug] [Thread-1  ]: On model.dev.mongodb_rides: Close
[0m16:49:39.430388 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41e7fbda-4998-4558-a9bb-4808c8647478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e64d00>]}
[0m16:49:39.430943 [info ] [Thread-1  ]: 1 of 1 OK created sql table model iceberg.landing.mongodb_rides ................ [[32mSUCCESS[0m in 3.99s]
[0m16:49:39.431468 [debug] [Thread-1  ]: Finished running node model.dev.mongodb_rides
[0m16:49:39.432598 [debug] [MainThread]: On master: COMMIT
[0m16:49:39.433119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:49:39.433378 [debug] [MainThread]: Connection 'model.dev.mongodb_rides' was properly closed.
[0m16:49:39.433656 [info ] [MainThread]: 
[0m16:49:39.433965 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.95 seconds (5.95s).
[0m16:49:39.434513 [debug] [MainThread]: Command end result
[0m16:49:39.443096 [info ] [MainThread]: 
[0m16:49:39.443417 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:49:39.443678 [info ] [MainThread]: 
[0m16:49:39.443946 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:49:39.446446 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.2308006, "process_user_time": 1.47055, "process_kernel_time": 0.172287, "process_mem_max_rss": "111640576", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:49:39.446815 [debug] [MainThread]: Command `cli run` succeeded at 16:49:39.446714 after 6.23 seconds
[0m16:49:39.447108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e84f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e5aee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107774e50>]}
[0m16:49:39.447405 [debug] [MainThread]: Flushing usage events
[0m16:51:59.018439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ae8160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065719a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065b0550>]}


============================== 16:51:59.021185 | 7aa73921-1e3a-4bc5-916f-5ba388e56a5c ==============================
[0m16:51:59.021185 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:51:59.021498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:51:59.144887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7aa73921-1e3a-4bc5-916f-5ba388e56a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10659ea30>]}
[0m16:51:59.190934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7aa73921-1e3a-4bc5-916f-5ba388e56a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10677d0a0>]}
[0m16:51:59.191382 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:51:59.202382 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m16:51:59.247502 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:51:59.247801 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:51:59.251589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7aa73921-1e3a-4bc5-916f-5ba388e56a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ec4f70>]}
[0m16:51:59.257522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7aa73921-1e3a-4bc5-916f-5ba388e56a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ded820>]}
[0m16:51:59.257808 [info ] [MainThread]: Found 9 models, 8 sources, 0 exposures, 0 metrics, 423 macros, 0 groups, 0 semantic models
[0m16:51:59.258025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7aa73921-1e3a-4bc5-916f-5ba388e56a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ded9a0>]}
[0m16:51:59.258704 [info ] [MainThread]: 
[0m16:51:59.258897 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:51:59.259172 [debug] [MainThread]: Command end result
[0m16:51:59.275517 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.29298884, "process_user_time": 1.198258, "process_kernel_time": 0.155202, "process_mem_max_rss": "110231552", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:51:59.275863 [debug] [MainThread]: Command `cli test` succeeded at 16:51:59.275795 after 0.29 seconds
[0m16:51:59.276070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ae8160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f3070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10659ea30>]}
[0m16:51:59.276266 [debug] [MainThread]: Flushing usage events
[0m16:52:14.447190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f7ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d4cf10>]}


============================== 16:52:14.449863 | e43b0aa5-9112-4595-9053-30205c3c12f5 ==============================
[0m16:52:14.449863 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:52:14.450209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'debug': 'False', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m16:52:14.566718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e43b0aa5-9112-4595-9053-30205c3c12f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ce4fd0>]}
[0m16:52:14.607805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e43b0aa5-9112-4595-9053-30205c3c12f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105053730>]}
[0m16:52:14.608101 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:52:14.618878 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m16:52:14.667048 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:52:14.667323 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:52:14.670980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e43b0aa5-9112-4595-9053-30205c3c12f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105233f40>]}
[0m16:52:14.679481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e43b0aa5-9112-4595-9053-30205c3c12f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10515b730>]}
[0m16:52:14.679728 [info ] [MainThread]: Found 9 models, 8 sources, 0 exposures, 0 metrics, 423 macros, 0 groups, 0 semantic models
[0m16:52:14.679931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e43b0aa5-9112-4595-9053-30205c3c12f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10515b9a0>]}
[0m16:52:14.680638 [info ] [MainThread]: 
[0m16:52:14.681067 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:52:14.681647 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m16:52:14.690237 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m16:52:14.690447 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m16:52:14.690620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:15.647049 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:52:15.648221 [debug] [ThreadPool]: On list_iceberg: Close
[0m16:52:15.649617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_landing)
[0m16:52:15.655875 [debug] [ThreadPool]: Using trino connection "list_iceberg_landing"
[0m16:52:15.656157 [debug] [ThreadPool]: On list_iceberg_landing: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg_landing"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'landing') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'landing'
[0m16:52:15.656387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:16.609343 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:52:16.614205 [debug] [ThreadPool]: On list_iceberg_landing: ROLLBACK
[0m16:52:16.615143 [debug] [ThreadPool]: On list_iceberg_landing: Close
[0m16:52:16.620089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e43b0aa5-9112-4595-9053-30205c3c12f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f94850>]}
[0m16:52:16.621028 [debug] [MainThread]: On master: COMMIT
[0m16:52:16.622067 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:52:16.622575 [info ] [MainThread]: 
[0m16:52:16.626989 [debug] [Thread-1  ]: Began running node model.dev.mongodb_rides
[0m16:52:16.627522 [info ] [Thread-1  ]: 1 of 1 START sql table model iceberg.landing.mongodb_rides ..................... [RUN]
[0m16:52:16.628242 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_landing, now model.dev.mongodb_rides)
[0m16:52:16.628639 [debug] [Thread-1  ]: Began compiling node model.dev.mongodb_rides
[0m16:52:16.634390 [debug] [Thread-1  ]: Writing injected SQL for node "model.dev.mongodb_rides"
[0m16:52:16.636208 [debug] [Thread-1  ]: Timing info for model.dev.mongodb_rides (compile): 16:52:16.628883 => 16:52:16.635949
[0m16:52:16.636585 [debug] [Thread-1  ]: Began executing node model.dev.mongodb_rides
[0m16:52:16.665205 [debug] [Thread-1  ]: Writing runtime sql for node "model.dev.mongodb_rides"
[0m16:52:16.669378 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_rides"
[0m16:52:16.669684 [debug] [Thread-1  ]: On model.dev.mongodb_rides: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_rides"} */

  
    

    create table "iceberg"."landing"."mongodb_rides__dbt_tmp"
      
      
    as (
      

SELECT
    
    CAST(FLOOR(random() * (10000 - 1 + 1)) + 1 AS INTEGER)
 AS ride_id,
    CAST(
        user_id AS INT
    ) AS user_id,
    cpf AS cpf,
    CAST(
        vehicle_id AS INT
    ) AS vehicle_id,
    
    CAST(FLOOR(random() * (10000 - 1 + 1)) + 1 AS INTEGER)
 AS subscription_id,
    
    CAST(FLOOR(random() * (10000 - 1 + 1)) + 1 AS INTEGER)
 AS payment_id,
    
    CAST(FLOOR(random() * (10000 - 1 + 1)) + 1 AS INTEGER)
 AS stripe_id,
    source AS source,
    destination AS destination,
    CAST(
        price AS REAL
    ) AS estimated_price,
    surge_multiplier AS surge_multiplier,
    CASE
        WHEN surge_multiplier <> 1 THEN CAST(
            price AS REAL
        ) * surge_multiplier
        ELSE CAST(
            price AS REAL
        )
    END AS price,
    NAME AS car_type,
    cab_type AS service_type,
    CAST(
        dt_current_timestamp AS TIMESTAMP
    ) AS last_updated
FROM
    "minio"."landing"."mongodb_rides_parquet"
    )
[0m16:52:16.669953 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:52:18.852496 [debug] [Thread-1  ]: SQL status: SUCCESS in 2.0 seconds
[0m16:52:18.865518 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_rides"
[0m16:52:18.866092 [debug] [Thread-1  ]: On model.dev.mongodb_rides: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_rides"} */
alter table "iceberg"."landing"."mongodb_rides" rename to "iceberg"."landing"."mongodb_rides__dbt_backup"
[0m16:52:19.416122 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:52:19.426837 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_rides"
[0m16:52:19.427503 [debug] [Thread-1  ]: On model.dev.mongodb_rides: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_rides"} */
alter table "iceberg"."landing"."mongodb_rides__dbt_tmp" rename to "iceberg"."landing"."mongodb_rides"
[0m16:52:20.018054 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:52:20.032096 [debug] [Thread-1  ]: Applying DROP to: "iceberg"."landing"."mongodb_rides__dbt_backup"
[0m16:52:20.034314 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_rides"
[0m16:52:20.034750 [debug] [Thread-1  ]: On model.dev.mongodb_rides: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_rides"} */

    drop table if exists "iceberg"."landing"."mongodb_rides__dbt_backup"
[0m16:52:20.586491 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:52:20.608926 [debug] [Thread-1  ]: Timing info for model.dev.mongodb_rides (execute): 16:52:16.636797 => 16:52:20.608714
[0m16:52:20.609338 [debug] [Thread-1  ]: On model.dev.mongodb_rides: ROLLBACK
[0m16:52:20.609661 [debug] [Thread-1  ]: On model.dev.mongodb_rides: Close
[0m16:52:20.610511 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e43b0aa5-9112-4595-9053-30205c3c12f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d4d30>]}
[0m16:52:20.611059 [info ] [Thread-1  ]: 1 of 1 OK created sql table model iceberg.landing.mongodb_rides ................ [[32mSUCCESS[0m in 3.98s]
[0m16:52:20.611596 [debug] [Thread-1  ]: Finished running node model.dev.mongodb_rides
[0m16:52:20.612730 [debug] [MainThread]: On master: COMMIT
[0m16:52:20.613243 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:52:20.613501 [debug] [MainThread]: Connection 'model.dev.mongodb_rides' was properly closed.
[0m16:52:20.613779 [info ] [MainThread]: 
[0m16:52:20.614089 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.93 seconds (5.93s).
[0m16:52:20.614628 [debug] [MainThread]: Command end result
[0m16:52:20.623390 [info ] [MainThread]: 
[0m16:52:20.623716 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:52:20.623976 [info ] [MainThread]: 
[0m16:52:20.624250 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:52:20.627028 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.215223, "process_user_time": 1.487998, "process_kernel_time": 0.186972, "process_mem_max_rss": "110493696", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:52:20.627395 [debug] [MainThread]: Command `cli run` succeeded at 16:52:20.627300 after 6.22 seconds
[0m16:52:20.627684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f7ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f94ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105053730>]}
[0m16:52:20.627978 [debug] [MainThread]: Flushing usage events
[0m16:53:08.592082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b84f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a45da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a49ca90>]}


============================== 16:53:08.595471 | 997e0cb2-ad5c-4e1b-80fc-c2501ef9c08b ==============================
[0m16:53:08.595471 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:53:08.595807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'version_check': 'True', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:53:08.717710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '997e0cb2-ad5c-4e1b-80fc-c2501ef9c08b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6b8d00>]}
[0m16:53:08.759423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '997e0cb2-ad5c-4e1b-80fc-c2501ef9c08b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7b31c0>]}
[0m16:53:08.759761 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:53:08.770357 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m16:53:08.820864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:53:08.821166 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:53:08.824895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '997e0cb2-ad5c-4e1b-80fc-c2501ef9c08b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa82f10>]}
[0m16:53:08.831309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '997e0cb2-ad5c-4e1b-80fc-c2501ef9c08b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9b1700>]}
[0m16:53:08.831584 [info ] [MainThread]: Found 9 models, 8 sources, 0 exposures, 0 metrics, 423 macros, 0 groups, 0 semantic models
[0m16:53:08.831814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '997e0cb2-ad5c-4e1b-80fc-c2501ef9c08b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9b1970>]}
[0m16:53:08.832661 [info ] [MainThread]: 
[0m16:53:08.833074 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:53:08.833666 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m16:53:08.842347 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m16:53:08.842570 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m16:53:08.842750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:09.659714 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:53:09.661768 [debug] [ThreadPool]: On list_iceberg: Close
[0m16:53:09.664267 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_landing)
[0m16:53:09.673677 [debug] [ThreadPool]: Using trino connection "list_iceberg_landing"
[0m16:53:09.674122 [debug] [ThreadPool]: On list_iceberg_landing: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg_landing"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'landing') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'landing'
[0m16:53:09.674450 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:53:10.635675 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:53:10.639206 [debug] [ThreadPool]: On list_iceberg_landing: ROLLBACK
[0m16:53:10.639924 [debug] [ThreadPool]: On list_iceberg_landing: Close
[0m16:53:10.645140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '997e0cb2-ad5c-4e1b-80fc-c2501ef9c08b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9b1460>]}
[0m16:53:10.645902 [debug] [MainThread]: On master: COMMIT
[0m16:53:10.646828 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:53:10.647292 [info ] [MainThread]: 
[0m16:53:10.651528 [debug] [Thread-1  ]: Began running node model.dev.mongodb_stripe
[0m16:53:10.652074 [info ] [Thread-1  ]: 1 of 1 START sql table model iceberg.landing.mongodb_stripe .................... [RUN]
[0m16:53:10.652814 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_landing, now model.dev.mongodb_stripe)
[0m16:53:10.653222 [debug] [Thread-1  ]: Began compiling node model.dev.mongodb_stripe
[0m16:53:10.657392 [debug] [Thread-1  ]: Writing injected SQL for node "model.dev.mongodb_stripe"
[0m16:53:10.658955 [debug] [Thread-1  ]: Timing info for model.dev.mongodb_stripe (compile): 16:53:10.653472 => 16:53:10.658698
[0m16:53:10.659340 [debug] [Thread-1  ]: Began executing node model.dev.mongodb_stripe
[0m16:53:10.689574 [debug] [Thread-1  ]: Writing runtime sql for node "model.dev.mongodb_stripe"
[0m16:53:10.691641 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_stripe"
[0m16:53:10.691913 [debug] [Thread-1  ]: On model.dev.mongodb_stripe: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_stripe"} */

  
    

    create table "iceberg"."landing"."mongodb_stripe__dbt_tmp"
      
      
    as (
      

SELECT
    DISTINCT CAST(
        id AS INT
    ) AS stripe_id,
    UID AS identifier,
    token AS card_type,
    ccv AS card_ccv,
    CAST(
        dt_current_timestamp AS TIMESTAMP
    ) AS last_updated
FROM
    "minio"."landing"."mongodb_stripe_parquet"
    )
[0m16:53:10.692170 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:53:12.769854 [debug] [Thread-1  ]: SQL status: SUCCESS in 2.0 seconds
[0m16:53:12.784364 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_stripe"
[0m16:53:12.784922 [debug] [Thread-1  ]: On model.dev.mongodb_stripe: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_stripe"} */
alter table "iceberg"."landing"."mongodb_stripe__dbt_tmp" rename to "iceberg"."landing"."mongodb_stripe"
[0m16:53:13.330704 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:53:13.346358 [debug] [Thread-1  ]: Applying DROP to: "iceberg"."landing"."mongodb_stripe__dbt_backup"
[0m16:53:13.348638 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_stripe"
[0m16:53:13.349070 [debug] [Thread-1  ]: On model.dev.mongodb_stripe: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_stripe"} */

    drop table if exists "iceberg"."landing"."mongodb_stripe__dbt_backup"
[0m16:53:13.901182 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:53:13.965895 [debug] [Thread-1  ]: Timing info for model.dev.mongodb_stripe (execute): 16:53:10.659577 => 16:53:13.965730
[0m16:53:13.966258 [debug] [Thread-1  ]: On model.dev.mongodb_stripe: ROLLBACK
[0m16:53:13.966475 [debug] [Thread-1  ]: On model.dev.mongodb_stripe: Close
[0m16:53:13.967186 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '997e0cb2-ad5c-4e1b-80fc-c2501ef9c08b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aba6b80>]}
[0m16:53:13.967581 [info ] [Thread-1  ]: 1 of 1 OK created sql table model iceberg.landing.mongodb_stripe ............... [[32mSUCCESS[0m in 3.31s]
[0m16:53:13.967930 [debug] [Thread-1  ]: Finished running node model.dev.mongodb_stripe
[0m16:53:13.968777 [debug] [MainThread]: On master: COMMIT
[0m16:53:13.969124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:53:13.969298 [debug] [MainThread]: Connection 'model.dev.mongodb_stripe' was properly closed.
[0m16:53:13.969497 [info ] [MainThread]: 
[0m16:53:13.969702 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.14 seconds (5.14s).
[0m16:53:13.970071 [debug] [MainThread]: Command end result
[0m16:53:13.977724 [info ] [MainThread]: 
[0m16:53:13.977965 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:53:13.978154 [info ] [MainThread]: 
[0m16:53:13.978363 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:53:13.981420 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.427704, "process_user_time": 1.414581, "process_kernel_time": 0.192091, "process_mem_max_rss": "115032064", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:53:13.981721 [debug] [MainThread]: Command `cli run` succeeded at 16:53:13.981647 after 5.43 seconds
[0m16:53:13.981957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b84f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a45da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a434e50>]}
[0m16:53:13.982181 [debug] [MainThread]: Flushing usage events
[0m16:53:41.297624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d28dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077825e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077dcf10>]}


============================== 16:53:41.300781 | cd3c6660-5d30-4d56-b158-9e8307f1dfc2 ==============================
[0m16:53:41.300781 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:53:41.301091 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:53:41.426059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd3c6660-5d30-4d56-b158-9e8307f1dfc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107774fd0>]}
[0m16:53:41.470007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd3c6660-5d30-4d56-b158-9e8307f1dfc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae4730>]}
[0m16:53:41.470350 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:53:41.480411 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m16:53:41.532458 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:53:41.532901 [debug] [MainThread]: Partial parsing: updated file: dev://models/stage/mongodb_users.sql
[0m16:53:41.604716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd3c6660-5d30-4d56-b158-9e8307f1dfc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5af10>]}
[0m16:53:41.634700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd3c6660-5d30-4d56-b158-9e8307f1dfc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db3ee0>]}
[0m16:53:41.634983 [info ] [MainThread]: Found 9 models, 8 sources, 0 exposures, 0 metrics, 423 macros, 0 groups, 0 semantic models
[0m16:53:41.635193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd3c6660-5d30-4d56-b158-9e8307f1dfc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed8c10>]}
[0m16:53:41.635789 [info ] [MainThread]: 
[0m16:53:41.635976 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:53:41.636233 [debug] [MainThread]: Command end result
[0m16:53:41.656650 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.39620546, "process_user_time": 1.313065, "process_kernel_time": 0.169749, "process_mem_max_rss": "111263744", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:53:41.656925 [debug] [MainThread]: Command `cli test` succeeded at 16:53:41.656861 after 0.40 seconds
[0m16:53:41.657119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d28dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed8c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee0070>]}
[0m16:53:41.657323 [debug] [MainThread]: Flushing usage events
[0m16:53:48.578316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028349d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10478ad60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10479c760>]}


============================== 16:53:48.580810 | d8de90eb-47fe-4382-8e61-5267b176b1d7 ==============================
[0m16:53:48.580810 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:53:48.581149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:53:48.703738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8de90eb-47fe-4382-8e61-5267b176b1d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048b7e80>]}
[0m16:53:48.745419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8de90eb-47fe-4382-8e61-5267b176b1d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049c68b0>]}
[0m16:53:48.745770 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:53:48.754882 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m16:53:48.800667 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:53:48.800930 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:53:48.804172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8de90eb-47fe-4382-8e61-5267b176b1d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d82ee0>]}
[0m16:53:48.811389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8de90eb-47fe-4382-8e61-5267b176b1d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cab6d0>]}
[0m16:53:48.811830 [info ] [MainThread]: Found 9 models, 8 sources, 0 exposures, 0 metrics, 423 macros, 0 groups, 0 semantic models
[0m16:53:48.812067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8de90eb-47fe-4382-8e61-5267b176b1d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cab940>]}
[0m16:53:48.812951 [info ] [MainThread]: 
[0m16:53:48.813424 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:53:48.814072 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m16:53:48.823186 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m16:53:48.823410 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m16:53:48.823589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:49.644082 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:53:49.649362 [debug] [ThreadPool]: On list_iceberg: Close
[0m16:53:49.653533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_landing)
[0m16:53:49.664398 [debug] [ThreadPool]: Using trino connection "list_iceberg_landing"
[0m16:53:49.664929 [debug] [ThreadPool]: On list_iceberg_landing: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg_landing"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'landing') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'landing'
[0m16:53:49.665300 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:53:50.605941 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:53:50.607865 [debug] [ThreadPool]: On list_iceberg_landing: ROLLBACK
[0m16:53:50.608243 [debug] [ThreadPool]: On list_iceberg_landing: Close
[0m16:53:50.611553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8de90eb-47fe-4382-8e61-5267b176b1d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ef400>]}
[0m16:53:50.612028 [debug] [MainThread]: On master: COMMIT
[0m16:53:50.612638 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:53:50.612959 [info ] [MainThread]: 
[0m16:53:50.615610 [debug] [Thread-1  ]: Began running node model.dev.mongodb_users
[0m16:53:50.616044 [info ] [Thread-1  ]: 1 of 1 START sql table model iceberg.landing.mongodb_users ..................... [RUN]
[0m16:53:50.616669 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_landing, now model.dev.mongodb_users)
[0m16:53:50.616998 [debug] [Thread-1  ]: Began compiling node model.dev.mongodb_users
[0m16:53:50.621924 [debug] [Thread-1  ]: Writing injected SQL for node "model.dev.mongodb_users"
[0m16:53:50.623180 [debug] [Thread-1  ]: Timing info for model.dev.mongodb_users (compile): 16:53:50.617203 => 16:53:50.622991
[0m16:53:50.623485 [debug] [Thread-1  ]: Began executing node model.dev.mongodb_users
[0m16:53:50.650360 [debug] [Thread-1  ]: Writing runtime sql for node "model.dev.mongodb_users"
[0m16:53:50.652884 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_users"
[0m16:53:50.653206 [debug] [Thread-1  ]: On model.dev.mongodb_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_users"} */

  
    

    create table "iceberg"."landing"."mongodb_users__dbt_tmp"
      
      
    as (
      

SELECT
    DISTINCT CAST(
        id AS INT
    ) AS id,
    CAST(
        user_id AS INT
    ) AS user_id,
    cpf AS cpf,
    CONCAT(
        first_name,
        ' ',
        last_name
    ) AS full_name,
    
    CASE
        WHEN email IS NULL THEN NULL
        ELSE CONCAT(SUBSTRING(email, 1, 1), '*****', SUBSTRING(email, strpos(email, '@')))
    END
 AS email,
    gender AS gender,
    phone_number AS phone_number,
    
    CONCAT('xxx-xx-', SUBSTRING(social_insurance_number, 8, 4))
 AS social_security_number,
    date_of_birth AS date_of_birth,
    CAST(
        dt_current_timestamp AS TIMESTAMP
    ) AS last_updated
FROM
    "minio"."landing"."mongodb_users_parquet"
    )
[0m16:53:50.653456 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:53:53.267668 [debug] [Thread-1  ]: SQL status: SUCCESS in 3.0 seconds
[0m16:53:53.277209 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_users"
[0m16:53:53.277676 [debug] [Thread-1  ]: On model.dev.mongodb_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_users"} */
alter table "iceberg"."landing"."mongodb_users__dbt_tmp" rename to "iceberg"."landing"."mongodb_users"
[0m16:53:53.826655 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:53:53.864721 [debug] [Thread-1  ]: Applying DROP to: "iceberg"."landing"."mongodb_users__dbt_backup"
[0m16:53:53.866231 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_users"
[0m16:53:53.866534 [debug] [Thread-1  ]: On model.dev.mongodb_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_users"} */

    drop table if exists "iceberg"."landing"."mongodb_users__dbt_backup"
[0m16:53:54.408951 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:53:54.433291 [debug] [Thread-1  ]: Timing info for model.dev.mongodb_users (execute): 16:53:50.623660 => 16:53:54.433060
[0m16:53:54.433733 [debug] [Thread-1  ]: On model.dev.mongodb_users: ROLLBACK
[0m16:53:54.434060 [debug] [Thread-1  ]: On model.dev.mongodb_users: Close
[0m16:53:54.434818 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8de90eb-47fe-4382-8e61-5267b176b1d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106028bb0>]}
[0m16:53:54.435311 [info ] [Thread-1  ]: 1 of 1 OK created sql table model iceberg.landing.mongodb_users ................ [[32mSUCCESS[0m in 3.82s]
[0m16:53:54.435827 [debug] [Thread-1  ]: Finished running node model.dev.mongodb_users
[0m16:53:54.436890 [debug] [MainThread]: On master: COMMIT
[0m16:53:54.437464 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:53:54.437740 [debug] [MainThread]: Connection 'model.dev.mongodb_users' was properly closed.
[0m16:53:54.438035 [info ] [MainThread]: 
[0m16:53:54.438350 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.62 seconds (5.62s).
[0m16:53:54.438903 [debug] [MainThread]: Command end result
[0m16:53:54.445937 [info ] [MainThread]: 
[0m16:53:54.446261 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:53:54.446520 [info ] [MainThread]: 
[0m16:53:54.446793 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:53:54.448874 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.903212, "process_user_time": 1.418502, "process_kernel_time": 0.160864, "process_mem_max_rss": "111788032", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:53:54.449247 [debug] [MainThread]: Command `cli run` succeeded at 16:53:54.449154 after 5.90 seconds
[0m16:53:54.449539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028349d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049d8af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103be1070>]}
[0m16:53:54.450041 [debug] [MainThread]: Flushing usage events
[0m16:54:11.500357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110465550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1172d86d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1172bb490>]}


============================== 16:54:11.502666 | 72efc772-b9a6-4157-aa96-baf4944fb0f9 ==============================
[0m16:54:11.502666 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:54:11.502987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'version_check': 'True', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m16:54:11.616638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72efc772-b9a6-4157-aa96-baf4944fb0f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1172a3610>]}
[0m16:54:11.658113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72efc772-b9a6-4157-aa96-baf4944fb0f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1175d4400>]}
[0m16:54:11.658451 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:54:11.669271 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m16:54:11.718572 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:54:11.718878 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:54:11.722777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72efc772-b9a6-4157-aa96-baf4944fb0f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1178c2fd0>]}
[0m16:54:11.728567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72efc772-b9a6-4157-aa96-baf4944fb0f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1176e97c0>]}
[0m16:54:11.728843 [info ] [MainThread]: Found 9 models, 8 sources, 0 exposures, 0 metrics, 423 macros, 0 groups, 0 semantic models
[0m16:54:11.729058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72efc772-b9a6-4157-aa96-baf4944fb0f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1176e9a30>]}
[0m16:54:11.729761 [info ] [MainThread]: 
[0m16:54:11.730161 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:54:11.730670 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m16:54:11.739571 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m16:54:11.739782 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m16:54:11.739949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:12.703176 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:54:12.707052 [debug] [ThreadPool]: On list_iceberg: Close
[0m16:54:12.711304 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_landing)
[0m16:54:12.722247 [debug] [ThreadPool]: Using trino connection "list_iceberg_landing"
[0m16:54:12.722999 [debug] [ThreadPool]: On list_iceberg_landing: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg_landing"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'landing') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'landing'
[0m16:54:12.723390 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:13.545970 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:54:13.551210 [debug] [ThreadPool]: On list_iceberg_landing: ROLLBACK
[0m16:54:13.552020 [debug] [ThreadPool]: On list_iceberg_landing: Close
[0m16:54:13.557522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72efc772-b9a6-4157-aa96-baf4944fb0f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1174e86d0>]}
[0m16:54:13.558368 [debug] [MainThread]: On master: COMMIT
[0m16:54:13.559295 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:54:13.559757 [info ] [MainThread]: 
[0m16:54:13.564094 [debug] [Thread-1  ]: Began running node model.dev.mssql_credit_card
[0m16:54:13.564975 [info ] [Thread-1  ]: 1 of 1 START sql table model iceberg.landing.mssql_credit_card ................. [RUN]
[0m16:54:13.565875 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_landing, now model.dev.mssql_credit_card)
[0m16:54:13.566293 [debug] [Thread-1  ]: Began compiling node model.dev.mssql_credit_card
[0m16:54:13.570637 [debug] [Thread-1  ]: Writing injected SQL for node "model.dev.mssql_credit_card"
[0m16:54:13.572400 [debug] [Thread-1  ]: Timing info for model.dev.mssql_credit_card (compile): 16:54:13.566541 => 16:54:13.572147
[0m16:54:13.572791 [debug] [Thread-1  ]: Began executing node model.dev.mssql_credit_card
[0m16:54:13.603123 [debug] [Thread-1  ]: Writing runtime sql for node "model.dev.mssql_credit_card"
[0m16:54:13.605110 [debug] [Thread-1  ]: Using trino connection "model.dev.mssql_credit_card"
[0m16:54:13.605409 [debug] [Thread-1  ]: On model.dev.mssql_credit_card: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mssql_credit_card"} */

  
    

    create table "iceberg"."landing"."mssql_credit_card__dbt_tmp"
      
      
    as (
      

SELECT
    DISTINCT CAST(
        id AS INT
    ) AS credit_card_id,
    CAST(
        user_id AS INT
    ) AS user_id,
    UID AS tsn_uid,
    credit_card_number AS credit_card_number,
    CAST(
        credit_card_expiry_date AS DATE
    ) AS credit_card_expiry,
    credit_card_type AS credit_card_type,
    CAST(
        dt_current_timestamp AS TIMESTAMP
    ) AS last_updated
FROM
    "minio"."landing"."mssql_credit_card_parquet"
    )
[0m16:54:13.605696 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:54:15.823250 [debug] [Thread-1  ]: SQL status: SUCCESS in 2.0 seconds
[0m16:54:15.837659 [debug] [Thread-1  ]: Using trino connection "model.dev.mssql_credit_card"
[0m16:54:15.838233 [debug] [Thread-1  ]: On model.dev.mssql_credit_card: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mssql_credit_card"} */
alter table "iceberg"."landing"."mssql_credit_card__dbt_tmp" rename to "iceberg"."landing"."mssql_credit_card"
[0m16:54:16.401911 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:54:16.416173 [debug] [Thread-1  ]: Applying DROP to: "iceberg"."landing"."mssql_credit_card__dbt_backup"
[0m16:54:16.458375 [debug] [Thread-1  ]: Using trino connection "model.dev.mssql_credit_card"
[0m16:54:16.458820 [debug] [Thread-1  ]: On model.dev.mssql_credit_card: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mssql_credit_card"} */

    drop table if exists "iceberg"."landing"."mssql_credit_card__dbt_backup"
[0m16:54:17.005632 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:54:17.028665 [debug] [Thread-1  ]: Timing info for model.dev.mssql_credit_card (execute): 16:54:13.573015 => 16:54:17.028409
[0m16:54:17.029185 [debug] [Thread-1  ]: On model.dev.mssql_credit_card: ROLLBACK
[0m16:54:17.029522 [debug] [Thread-1  ]: On model.dev.mssql_credit_card: Close
[0m16:54:17.030526 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72efc772-b9a6-4157-aa96-baf4944fb0f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117963df0>]}
[0m16:54:17.031112 [info ] [Thread-1  ]: 1 of 1 OK created sql table model iceberg.landing.mssql_credit_card ............ [[32mSUCCESS[0m in 3.47s]
[0m16:54:17.031641 [debug] [Thread-1  ]: Finished running node model.dev.mssql_credit_card
[0m16:54:17.032921 [debug] [MainThread]: On master: COMMIT
[0m16:54:17.033537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:54:17.033827 [debug] [MainThread]: Connection 'model.dev.mssql_credit_card' was properly closed.
[0m16:54:17.034138 [info ] [MainThread]: 
[0m16:54:17.034471 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.30 seconds (5.30s).
[0m16:54:17.035040 [debug] [MainThread]: Command end result
[0m16:54:17.043305 [info ] [MainThread]: 
[0m16:54:17.043683 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:54:17.043974 [info ] [MainThread]: 
[0m16:54:17.044266 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:54:17.046840 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.5782356, "process_user_time": 1.483227, "process_kernel_time": 0.191495, "process_mem_max_rss": "111198208", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:54:17.047213 [debug] [MainThread]: Command `cli run` succeeded at 16:54:17.047114 after 5.58 seconds
[0m16:54:17.047502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110465550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117594940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1174d2850>]}
[0m16:54:17.047802 [debug] [MainThread]: Flushing usage events
[0m16:54:47.010260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027d9b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10452c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10450f460>]}


============================== 16:54:47.012532 | b8a99235-ae88-4798-90e2-91515da499cd ==============================
[0m16:54:47.012532 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:54:47.012854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m16:54:47.137094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8a99235-ae88-4798-90e2-91515da499cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10452c850>]}
[0m16:54:47.178426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8a99235-ae88-4798-90e2-91515da499cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104829a00>]}
[0m16:54:47.178730 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:54:47.188580 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m16:54:47.227054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:54:47.227371 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:54:47.231148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8a99235-ae88-4798-90e2-91515da499cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a12f40>]}
[0m16:54:47.237453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8a99235-ae88-4798-90e2-91515da499cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049408b0>]}
[0m16:54:47.237754 [info ] [MainThread]: Found 9 models, 8 sources, 0 exposures, 0 metrics, 423 macros, 0 groups, 0 semantic models
[0m16:54:47.237977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8a99235-ae88-4798-90e2-91515da499cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104940a30>]}
[0m16:54:47.238746 [info ] [MainThread]: 
[0m16:54:47.239172 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:54:47.239741 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m16:54:47.248665 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m16:54:47.248940 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m16:54:47.249121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:48.066527 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:54:48.067908 [debug] [ThreadPool]: On list_iceberg: Close
[0m16:54:48.069332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_landing)
[0m16:54:48.075014 [debug] [ThreadPool]: Using trino connection "list_iceberg_landing"
[0m16:54:48.075292 [debug] [ThreadPool]: On list_iceberg_landing: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg_landing"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'landing') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'landing'
[0m16:54:48.075499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:49.011214 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:54:49.012940 [debug] [ThreadPool]: On list_iceberg_landing: ROLLBACK
[0m16:54:49.013339 [debug] [ThreadPool]: On list_iceberg_landing: Close
[0m16:54:49.017351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8a99235-ae88-4798-90e2-91515da499cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10464e130>]}
[0m16:54:49.017832 [debug] [MainThread]: On master: COMMIT
[0m16:54:49.018488 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:54:49.018819 [info ] [MainThread]: 
[0m16:54:49.021146 [debug] [Thread-1  ]: Began running node model.dev.mssql_users
[0m16:54:49.021569 [info ] [Thread-1  ]: 1 of 1 START sql table model iceberg.landing.mssql_users ....................... [RUN]
[0m16:54:49.022183 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_landing, now model.dev.mssql_users)
[0m16:54:49.022514 [debug] [Thread-1  ]: Began compiling node model.dev.mssql_users
[0m16:54:49.025918 [debug] [Thread-1  ]: Writing injected SQL for node "model.dev.mssql_users"
[0m16:54:49.026953 [debug] [Thread-1  ]: Timing info for model.dev.mssql_users (compile): 16:54:49.022729 => 16:54:49.026770
[0m16:54:49.027246 [debug] [Thread-1  ]: Began executing node model.dev.mssql_users
[0m16:54:49.054313 [debug] [Thread-1  ]: Writing runtime sql for node "model.dev.mssql_users"
[0m16:54:49.056347 [debug] [Thread-1  ]: Using trino connection "model.dev.mssql_users"
[0m16:54:49.056608 [debug] [Thread-1  ]: On model.dev.mssql_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mssql_users"} */

  
    

    create table "iceberg"."landing"."mssql_users__dbt_tmp"
      
      
    as (
      

SELECT
    DISTINCT CAST(
        user_id AS INT
    ) AS user_id,
    cpf AS cpf,
    CONCAT(
        first_name,
        ' ',
        last_name
    ) AS full_name,
    CAST(
        date_birth AS DATE
    ) AS date_of_birth,
    city AS city,
    country AS country,
    company_name AS company_name,
    job AS job,
    phone_number AS phone_number,
    time_zone AS time_zone,
    CAST(
        dt_current_timestamp AS TIMESTAMP
    ) AS last_updated
FROM
    "minio"."landing"."mssql_users_parquet"
    )
[0m16:54:49.056849 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:54:52.056516 [debug] [Thread-1  ]: SQL status: SUCCESS in 3.0 seconds
[0m16:54:52.068396 [debug] [Thread-1  ]: Using trino connection "model.dev.mssql_users"
[0m16:54:52.069032 [debug] [Thread-1  ]: On model.dev.mssql_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mssql_users"} */
alter table "iceberg"."landing"."mssql_users__dbt_tmp" rename to "iceberg"."landing"."mssql_users"
[0m16:54:52.616269 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:54:52.630520 [debug] [Thread-1  ]: Applying DROP to: "iceberg"."landing"."mssql_users__dbt_backup"
[0m16:54:52.673710 [debug] [Thread-1  ]: Using trino connection "model.dev.mssql_users"
[0m16:54:52.674138 [debug] [Thread-1  ]: On model.dev.mssql_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mssql_users"} */

    drop table if exists "iceberg"."landing"."mssql_users__dbt_backup"
[0m16:54:53.211159 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:54:53.219763 [debug] [Thread-1  ]: Timing info for model.dev.mssql_users (execute): 16:54:49.027422 => 16:54:53.219633
[0m16:54:53.220046 [debug] [Thread-1  ]: On model.dev.mssql_users: ROLLBACK
[0m16:54:53.220250 [debug] [Thread-1  ]: On model.dev.mssql_users: Close
[0m16:54:53.220809 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a99235-ae88-4798-90e2-91515da499cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ab4fd0>]}
[0m16:54:53.221132 [info ] [Thread-1  ]: 1 of 1 OK created sql table model iceberg.landing.mssql_users .................. [[32mSUCCESS[0m in 4.20s]
[0m16:54:53.221429 [debug] [Thread-1  ]: Finished running node model.dev.mssql_users
[0m16:54:53.222295 [debug] [MainThread]: On master: COMMIT
[0m16:54:53.222667 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:54:53.222840 [debug] [MainThread]: Connection 'model.dev.mssql_users' was properly closed.
[0m16:54:53.223021 [info ] [MainThread]: 
[0m16:54:53.223211 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.98 seconds (5.98s).
[0m16:54:53.223556 [debug] [MainThread]: Command end result
[0m16:54:53.230597 [info ] [MainThread]: 
[0m16:54:53.230852 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:54:53.231049 [info ] [MainThread]: 
[0m16:54:53.231245 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:54:53.233127 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.254044, "process_user_time": 1.42103, "process_kernel_time": 0.185689, "process_mem_max_rss": "113278976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:54:53.233443 [debug] [MainThread]: Command `cli run` succeeded at 16:54:53.233369 after 6.25 seconds
[0m16:54:53.233668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027d9b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b2b220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10452c850>]}
[0m16:54:53.233890 [debug] [MainThread]: Flushing usage events
[0m16:55:11.837256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d76550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d82610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ddcf10>]}


============================== 16:55:11.840907 | b77b2282-1f28-41b2-8ccf-b5daf9e455e2 ==============================
[0m16:55:11.840907 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:55:11.841239 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:55:11.967990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b77b2282-1f28-41b2-8ccf-b5daf9e455e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d74fd0>]}
[0m16:55:12.009725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b77b2282-1f28-41b2-8ccf-b5daf9e455e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e3730>]}
[0m16:55:12.010053 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:55:12.020409 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m16:55:12.072768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:55:12.073103 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:55:12.077082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b77b2282-1f28-41b2-8ccf-b5daf9e455e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c2f70>]}
[0m16:55:12.085530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b77b2282-1f28-41b2-8ccf-b5daf9e455e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ea760>]}
[0m16:55:12.085791 [info ] [MainThread]: Found 9 models, 8 sources, 0 exposures, 0 metrics, 423 macros, 0 groups, 0 semantic models
[0m16:55:12.086011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b77b2282-1f28-41b2-8ccf-b5daf9e455e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ea9d0>]}
[0m16:55:12.086781 [info ] [MainThread]: 
[0m16:55:12.087178 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:55:12.087734 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m16:55:12.096558 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m16:55:12.096766 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m16:55:12.096943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:13.043521 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:55:13.045588 [debug] [ThreadPool]: On list_iceberg: Close
[0m16:55:13.048115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_landing)
[0m16:55:13.057519 [debug] [ThreadPool]: Using trino connection "list_iceberg_landing"
[0m16:55:13.057920 [debug] [ThreadPool]: On list_iceberg_landing: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg_landing"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'landing') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'landing'
[0m16:55:13.058246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:14.014525 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:55:14.015833 [debug] [ThreadPool]: On list_iceberg_landing: ROLLBACK
[0m16:55:14.016116 [debug] [ThreadPool]: On list_iceberg_landing: Close
[0m16:55:14.018991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b77b2282-1f28-41b2-8ccf-b5daf9e455e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108124850>]}
[0m16:55:14.019396 [debug] [MainThread]: On master: COMMIT
[0m16:55:14.019866 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:55:14.020112 [info ] [MainThread]: 
[0m16:55:14.022573 [debug] [Thread-1  ]: Began running node model.dev.postgres_payments
[0m16:55:14.022937 [info ] [Thread-1  ]: 1 of 1 START sql table model iceberg.landing.postgres_payments ................. [RUN]
[0m16:55:14.023432 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_landing, now model.dev.postgres_payments)
[0m16:55:14.023709 [debug] [Thread-1  ]: Began compiling node model.dev.postgres_payments
[0m16:55:14.026387 [debug] [Thread-1  ]: Timing info for model.dev.postgres_payments (compile): 16:55:14.023871 => 16:55:14.026153
[0m16:55:14.026934 [error] [Thread-1  ]: [31mUnhandled error while executing [0m
keyword argument repeated: tags (<template>, line 13)
[0m16:55:14.049859 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/dbt/task/base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/dbt/task/base.py", line 312, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/dbt/task/compile.py", line 44, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/dbt/compilation.py", line 538, in compile_node
    node = self._compile_code(node, manifest, extra_context)
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/dbt/compilation.py", line 427, in _compile_code
    node.compiled_code = jinja.get_rendered(
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/dbt/clients/jinja.py", line 592, in get_rendered
    template = get_template(
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/dbt/clients/jinja.py", line 541, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/jinja2/environment.py", line 1105, in from_string
    return cls.from_code(self, self.compile(source), gs, None)
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/jinja2/environment.py", line 766, in compile
    return self._compile(source, filename)
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/dbt/clients/jinja.py", line 107, in _compile
    return super()._compile(source, filename)  # type: ignore
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/jinja2/environment.py", line 704, in _compile
    return compile(source, filename, "exec")
  File "<template>", line 13
SyntaxError: keyword argument repeated: tags

[0m16:55:14.050431 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b77b2282-1f28-41b2-8ccf-b5daf9e455e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108548340>]}
[0m16:55:14.050889 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model iceberg.landing.postgres_payments ........ [[31mERROR[0m in 0.03s]
[0m16:55:14.051237 [debug] [Thread-1  ]: Finished running node model.dev.postgres_payments
[0m16:55:14.052264 [debug] [MainThread]: On master: COMMIT
[0m16:55:14.052684 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:14.052878 [debug] [MainThread]: Connection 'model.dev.postgres_payments' was properly closed.
[0m16:55:14.053099 [info ] [MainThread]: 
[0m16:55:14.053343 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.97 seconds (1.97s).
[0m16:55:14.053728 [debug] [MainThread]: Command end result
[0m16:55:14.061259 [info ] [MainThread]: 
[0m16:55:14.061560 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:55:14.061757 [info ] [MainThread]: 
[0m16:55:14.061955 [error] [MainThread]:   keyword argument repeated: tags (<template>, line 13)
[0m16:55:14.062137 [info ] [MainThread]: 
[0m16:55:14.062350 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:55:14.064781 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.2813258, "process_user_time": 1.25876, "process_kernel_time": 0.17664, "process_mem_max_rss": "110280704", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:55:14.065139 [debug] [MainThread]: Command `cli run` failed at 16:55:14.065068 after 2.28 seconds
[0m16:55:14.065389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d76550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e3730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e5df0>]}
[0m16:55:14.065630 [debug] [MainThread]: Flushing usage events
[0m16:55:25.697602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c78160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b21d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b25c550>]}


============================== 16:55:25.700068 | 3359651d-9946-40eb-ad56-32b38369dff4 ==============================
[0m16:55:25.700068 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:55:25.700387 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:55:25.816998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3359651d-9946-40eb-ad56-32b38369dff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b24aa30>]}
[0m16:55:25.857661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3359651d-9946-40eb-ad56-32b38369dff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4290a0>]}
[0m16:55:25.857976 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:55:25.870366 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m16:55:25.918253 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:55:25.918542 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:55:25.922291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3359651d-9946-40eb-ad56-32b38369dff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b842fa0>]}
[0m16:55:25.929370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3359651d-9946-40eb-ad56-32b38369dff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b774850>]}
[0m16:55:25.929633 [info ] [MainThread]: Found 9 models, 8 sources, 0 exposures, 0 metrics, 423 macros, 0 groups, 0 semantic models
[0m16:55:25.929853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3359651d-9946-40eb-ad56-32b38369dff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7749d0>]}
[0m16:55:25.930658 [info ] [MainThread]: 
[0m16:55:25.931074 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:55:25.931667 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m16:55:25.940380 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m16:55:25.940584 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m16:55:25.940770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:26.894082 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:55:26.897270 [debug] [ThreadPool]: On list_iceberg: Close
[0m16:55:26.901309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_landing)
[0m16:55:26.912854 [debug] [ThreadPool]: Using trino connection "list_iceberg_landing"
[0m16:55:26.913433 [debug] [ThreadPool]: On list_iceberg_landing: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg_landing"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'landing') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'landing'
[0m16:55:26.913783 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:27.877991 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:55:27.883788 [debug] [ThreadPool]: On list_iceberg_landing: ROLLBACK
[0m16:55:27.884744 [debug] [ThreadPool]: On list_iceberg_landing: Close
[0m16:55:27.891330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3359651d-9946-40eb-ad56-32b38369dff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2013d0>]}
[0m16:55:27.892023 [debug] [MainThread]: On master: COMMIT
[0m16:55:27.892921 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:55:27.893367 [info ] [MainThread]: 
[0m16:55:27.897401 [debug] [Thread-1  ]: Began running node model.dev.postgres_payments
[0m16:55:27.898126 [info ] [Thread-1  ]: 1 of 1 START sql table model iceberg.landing.postgres_payments ................. [RUN]
[0m16:55:27.898990 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_landing, now model.dev.postgres_payments)
[0m16:55:27.899398 [debug] [Thread-1  ]: Began compiling node model.dev.postgres_payments
[0m16:55:27.903518 [debug] [Thread-1  ]: Timing info for model.dev.postgres_payments (compile): 16:55:27.899645 => 16:55:27.903251
[0m16:55:27.904244 [error] [Thread-1  ]: [31mUnhandled error while executing [0m
keyword argument repeated: tags (<template>, line 13)
[0m16:55:27.918064 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/dbt/task/base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/dbt/task/base.py", line 312, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/dbt/task/compile.py", line 44, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/dbt/compilation.py", line 538, in compile_node
    node = self._compile_code(node, manifest, extra_context)
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/dbt/compilation.py", line 427, in _compile_code
    node.compiled_code = jinja.get_rendered(
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/dbt/clients/jinja.py", line 592, in get_rendered
    template = get_template(
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/dbt/clients/jinja.py", line 541, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/jinja2/environment.py", line 1105, in from_string
    return cls.from_code(self, self.compile(source), gs, None)
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/jinja2/environment.py", line 766, in compile
    return self._compile(source, filename)
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/dbt/clients/jinja.py", line 107, in _compile
    return super()._compile(source, filename)  # type: ignore
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/jinja2/environment.py", line 704, in _compile
    return compile(source, filename, "exec")
  File "<template>", line 13
SyntaxError: keyword argument repeated: tags

[0m16:55:27.918531 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3359651d-9946-40eb-ad56-32b38369dff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8ca370>]}
[0m16:55:27.919005 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model iceberg.landing.postgres_payments ........ [[31mERROR[0m in 0.02s]
[0m16:55:27.919431 [debug] [Thread-1  ]: Finished running node model.dev.postgres_payments
[0m16:55:27.920471 [debug] [MainThread]: On master: COMMIT
[0m16:55:27.921020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:27.921286 [debug] [MainThread]: Connection 'model.dev.postgres_payments' was properly closed.
[0m16:55:27.921569 [info ] [MainThread]: 
[0m16:55:27.921876 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.99 seconds (1.99s).
[0m16:55:27.922343 [debug] [MainThread]: Command end result
[0m16:55:27.930460 [info ] [MainThread]: 
[0m16:55:27.930798 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:55:27.931061 [info ] [MainThread]: 
[0m16:55:27.931324 [error] [MainThread]:   keyword argument repeated: tags (<template>, line 13)
[0m16:55:27.931572 [info ] [MainThread]: 
[0m16:55:27.931823 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:55:27.934442 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.2711742, "process_user_time": 1.280247, "process_kernel_time": 0.154284, "process_mem_max_rss": "111575040", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:55:27.934920 [debug] [MainThread]: Command `cli run` failed at 16:55:27.934825 after 2.27 seconds
[0m16:55:27.935216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c78160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3af580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b24aa30>]}
[0m16:55:27.935506 [debug] [MainThread]: Flushing usage events
[0m16:55:42.761606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ea04f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10745da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10749ca90>]}


============================== 16:55:42.764213 | a2a1a7b2-562a-4da6-88e6-ae9653cba9b4 ==============================
[0m16:55:42.764213 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:55:42.764534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:55:42.884412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2a1a7b2-562a-4da6-88e6-ae9653cba9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b8310>]}
[0m16:55:42.928056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2a1a7b2-562a-4da6-88e6-ae9653cba9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077b41c0>]}
[0m16:55:42.928443 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:55:42.939940 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m16:55:42.990741 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:55:42.991199 [debug] [MainThread]: Partial parsing: updated file: dev://models/stage/postgres_payments.sql
[0m16:55:43.058861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2a1a7b2-562a-4da6-88e6-ae9653cba9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11139e0d0>]}
[0m16:55:43.093272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2a1a7b2-562a-4da6-88e6-ae9653cba9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112729d0>]}
[0m16:55:43.093550 [info ] [MainThread]: Found 9 models, 8 sources, 0 exposures, 0 metrics, 423 macros, 0 groups, 0 semantic models
[0m16:55:43.093754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2a1a7b2-562a-4da6-88e6-ae9653cba9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113800d0>]}
[0m16:55:43.094379 [info ] [MainThread]: 
[0m16:55:43.094791 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:55:43.095335 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m16:55:43.104174 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m16:55:43.104394 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m16:55:43.104554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:43.912896 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:55:43.914817 [debug] [ThreadPool]: On list_iceberg: Close
[0m16:55:43.917126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_landing)
[0m16:55:43.925852 [debug] [ThreadPool]: Using trino connection "list_iceberg_landing"
[0m16:55:43.926285 [debug] [ThreadPool]: On list_iceberg_landing: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg_landing"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'landing') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'landing'
[0m16:55:43.926606 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:44.887078 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:55:44.889024 [debug] [ThreadPool]: On list_iceberg_landing: ROLLBACK
[0m16:55:44.889423 [debug] [ThreadPool]: On list_iceberg_landing: Close
[0m16:55:44.893491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2a1a7b2-562a-4da6-88e6-ae9653cba9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111292430>]}
[0m16:55:44.893977 [debug] [MainThread]: On master: COMMIT
[0m16:55:44.894581 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:55:44.894903 [info ] [MainThread]: 
[0m16:55:44.897158 [debug] [Thread-1  ]: Began running node model.dev.postgres_payments
[0m16:55:44.897674 [info ] [Thread-1  ]: 1 of 1 START sql table model iceberg.landing.postgres_payments ................. [RUN]
[0m16:55:44.898561 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_landing, now model.dev.postgres_payments)
[0m16:55:44.898917 [debug] [Thread-1  ]: Began compiling node model.dev.postgres_payments
[0m16:55:44.902158 [debug] [Thread-1  ]: Writing injected SQL for node "model.dev.postgres_payments"
[0m16:55:44.903297 [debug] [Thread-1  ]: Timing info for model.dev.postgres_payments (compile): 16:55:44.899130 => 16:55:44.903090
[0m16:55:44.903635 [debug] [Thread-1  ]: Began executing node model.dev.postgres_payments
[0m16:55:44.931429 [debug] [Thread-1  ]: Writing runtime sql for node "model.dev.postgres_payments"
[0m16:55:44.933488 [debug] [Thread-1  ]: Using trino connection "model.dev.postgres_payments"
[0m16:55:44.933750 [debug] [Thread-1  ]: On model.dev.postgres_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.postgres_payments"} */

  
    

    create table "iceberg"."landing"."postgres_payments__dbt_tmp"
      
      
    as (
      

SELECT
    DISTINCT CAST(
        user_id AS INT
    ) AS payment_id,
    CASE
        WHEN gender = 'm' THEN 'male'
        ELSE 'female'
    END AS gender,
    LANGUAGE AS LANGUAGE,
    race AS race,
    job_title AS job_title,
    city AS city,
    country AS country,
    currency AS currency,
    credit_card_type AS credit_card_type,
    CAST(REPLACE(subscription_price, '$', '') AS REAL) AS price,
    TIME AS issued_at,
    CAST(
        dt_current_timestamp AS TIMESTAMP
    ) AS last_updated
FROM
    "minio"."landing"."postgres_payments_parquet"
    )
[0m16:55:44.934005 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:55:47.202550 [debug] [Thread-1  ]: SQL status: SUCCESS in 2.0 seconds
[0m16:55:47.208896 [debug] [Thread-1  ]: Using trino connection "model.dev.postgres_payments"
[0m16:55:47.209255 [debug] [Thread-1  ]: On model.dev.postgres_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.postgres_payments"} */
alter table "iceberg"."landing"."postgres_payments__dbt_tmp" rename to "iceberg"."landing"."postgres_payments"
[0m16:55:47.752318 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:55:47.762429 [debug] [Thread-1  ]: Applying DROP to: "iceberg"."landing"."postgres_payments__dbt_backup"
[0m16:55:47.764073 [debug] [Thread-1  ]: Using trino connection "model.dev.postgres_payments"
[0m16:55:47.764364 [debug] [Thread-1  ]: On model.dev.postgres_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.postgres_payments"} */

    drop table if exists "iceberg"."landing"."postgres_payments__dbt_backup"
[0m16:55:48.306966 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:55:48.329042 [debug] [Thread-1  ]: Timing info for model.dev.postgres_payments (execute): 16:55:44.903817 => 16:55:48.328804
[0m16:55:48.329542 [debug] [Thread-1  ]: On model.dev.postgres_payments: ROLLBACK
[0m16:55:48.329877 [debug] [Thread-1  ]: On model.dev.postgres_payments: Close
[0m16:55:48.330755 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2a1a7b2-562a-4da6-88e6-ae9653cba9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11154d700>]}
[0m16:55:48.331279 [info ] [Thread-1  ]: 1 of 1 OK created sql table model iceberg.landing.postgres_payments ............ [[32mSUCCESS[0m in 3.43s]
[0m16:55:48.331798 [debug] [Thread-1  ]: Finished running node model.dev.postgres_payments
[0m16:55:48.333011 [debug] [MainThread]: On master: COMMIT
[0m16:55:48.333620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:48.333908 [debug] [MainThread]: Connection 'model.dev.postgres_payments' was properly closed.
[0m16:55:48.334208 [info ] [MainThread]: 
[0m16:55:48.334539 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.24 seconds (5.24s).
[0m16:55:48.335115 [debug] [MainThread]: Command end result
[0m16:55:48.343847 [info ] [MainThread]: 
[0m16:55:48.344244 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:55:48.344535 [info ] [MainThread]: 
[0m16:55:48.344822 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:55:48.347534 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.6205883, "process_user_time": 1.465807, "process_kernel_time": 0.18759, "process_mem_max_rss": "117145600", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:55:48.347937 [debug] [MainThread]: Command `cli run` succeeded at 16:55:48.347844 after 5.62 seconds
[0m16:55:48.348228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ea04f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11134adf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111582b20>]}
[0m16:55:48.348524 [debug] [MainThread]: Flushing usage events
[0m16:55:53.927119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d64250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c4a8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c5c340>]}


============================== 16:55:53.929530 | ae23237a-889b-47a0-b7f4-44e7f0933576 ==============================
[0m16:55:53.929530 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:55:53.929874 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:55:54.047024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae23237a-889b-47a0-b7f4-44e7f0933576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c2f2b0>]}
[0m16:55:54.089769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae23237a-889b-47a0-b7f4-44e7f0933576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b26940>]}
[0m16:55:54.090133 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:55:54.101613 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m16:55:54.153395 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:55:54.153706 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:55:54.157551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae23237a-889b-47a0-b7f4-44e7f0933576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122242f10>]}
[0m16:55:54.163705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae23237a-889b-47a0-b7f4-44e7f0933576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122171700>]}
[0m16:55:54.163996 [info ] [MainThread]: Found 9 models, 8 sources, 0 exposures, 0 metrics, 423 macros, 0 groups, 0 semantic models
[0m16:55:54.164217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae23237a-889b-47a0-b7f4-44e7f0933576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122171970>]}
[0m16:55:54.165081 [info ] [MainThread]: 
[0m16:55:54.165525 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:55:54.166159 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m16:55:54.175316 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m16:55:54.175534 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m16:55:54.175709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:55.130868 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:55:55.135357 [debug] [ThreadPool]: On list_iceberg: Close
[0m16:55:55.139385 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_landing)
[0m16:55:55.151425 [debug] [ThreadPool]: Using trino connection "list_iceberg_landing"
[0m16:55:55.152037 [debug] [ThreadPool]: On list_iceberg_landing: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg_landing"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'landing') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'landing'
[0m16:55:55.152416 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:56.101112 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:55:56.102722 [debug] [ThreadPool]: On list_iceberg_landing: ROLLBACK
[0m16:55:56.103038 [debug] [ThreadPool]: On list_iceberg_landing: Close
[0m16:55:56.106461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae23237a-889b-47a0-b7f4-44e7f0933576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ee9190>]}
[0m16:55:56.106858 [debug] [MainThread]: On master: COMMIT
[0m16:55:56.107413 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:55:56.107718 [info ] [MainThread]: 
[0m16:55:56.109500 [debug] [Thread-1  ]: Began running node model.dev.postgres_subscription
[0m16:55:56.109944 [info ] [Thread-1  ]: 1 of 1 START sql table model iceberg.landing.postgres_subscription ............. [RUN]
[0m16:55:56.110519 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_landing, now model.dev.postgres_subscription)
[0m16:55:56.110989 [debug] [Thread-1  ]: Began compiling node model.dev.postgres_subscription
[0m16:55:56.113785 [debug] [Thread-1  ]: Timing info for model.dev.postgres_subscription (compile): 16:55:56.111187 => 16:55:56.113584
[0m16:55:56.114376 [error] [Thread-1  ]: [31mUnhandled error while executing [0m
keyword argument repeated: tags (<template>, line 13)
[0m16:55:56.125605 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/dbt/task/base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/dbt/task/base.py", line 312, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/dbt/task/compile.py", line 44, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/dbt/compilation.py", line 538, in compile_node
    node = self._compile_code(node, manifest, extra_context)
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/dbt/compilation.py", line 427, in _compile_code
    node.compiled_code = jinja.get_rendered(
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/dbt/clients/jinja.py", line 592, in get_rendered
    template = get_template(
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/dbt/clients/jinja.py", line 541, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/jinja2/environment.py", line 1105, in from_string
    return cls.from_code(self, self.compile(source), gs, None)
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/jinja2/environment.py", line 766, in compile
    return self._compile(source, filename)
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/dbt/clients/jinja.py", line 107, in _compile
    return super()._compile(source, filename)  # type: ignore
  File "/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/venv/lib/python3.9/site-packages/jinja2/environment.py", line 704, in _compile
    return compile(source, filename, "exec")
  File "<template>", line 13
SyntaxError: keyword argument repeated: tags

[0m16:55:56.126023 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae23237a-889b-47a0-b7f4-44e7f0933576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12233ffd0>]}
[0m16:55:56.126437 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model iceberg.landing.postgres_subscription .... [[31mERROR[0m in 0.02s]
[0m16:55:56.126820 [debug] [Thread-1  ]: Finished running node model.dev.postgres_subscription
[0m16:55:56.127683 [debug] [MainThread]: On master: COMMIT
[0m16:55:56.128124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:56.128356 [debug] [MainThread]: Connection 'model.dev.postgres_subscription' was properly closed.
[0m16:55:56.128589 [info ] [MainThread]: 
[0m16:55:56.128839 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.96 seconds (1.96s).
[0m16:55:56.129256 [debug] [MainThread]: Command end result
[0m16:55:56.136042 [info ] [MainThread]: 
[0m16:55:56.136354 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:55:56.136584 [info ] [MainThread]: 
[0m16:55:56.136803 [error] [MainThread]:   keyword argument repeated: tags (<template>, line 13)
[0m16:55:56.137023 [info ] [MainThread]: 
[0m16:55:56.137265 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:55:56.139299 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.246345, "process_user_time": 1.29451, "process_kernel_time": 0.165668, "process_mem_max_rss": "112525312", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:55:56.139655 [debug] [MainThread]: Command `cli run` failed at 16:55:56.139572 after 2.25 seconds
[0m16:55:56.139936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d64250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121d930d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b26940>]}
[0m16:55:56.140199 [debug] [MainThread]: Flushing usage events
[0m16:56:16.834179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103265550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050c86d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050ab490>]}


============================== 16:56:16.836451 | 24ce2fbe-e71c-45fb-b5ff-0f2ad9546e2d ==============================
[0m16:56:16.836451 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:56:16.836785 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:56:16.953657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24ce2fbe-e71c-45fb-b5ff-0f2ad9546e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105093610>]}
[0m16:56:16.995004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24ce2fbe-e71c-45fb-b5ff-0f2ad9546e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054d9400>]}
[0m16:56:16.995301 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:56:17.005865 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m16:56:17.048402 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:56:17.048838 [debug] [MainThread]: Partial parsing: updated file: dev://models/stage/postgres_subscription.sql
[0m16:56:17.115733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24ce2fbe-e71c-45fb-b5ff-0f2ad9546e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057df0d0>]}
[0m16:56:17.148936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24ce2fbe-e71c-45fb-b5ff-0f2ad9546e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056b1220>]}
[0m16:56:17.149209 [info ] [MainThread]: Found 9 models, 8 sources, 0 exposures, 0 metrics, 423 macros, 0 groups, 0 semantic models
[0m16:56:17.149427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24ce2fbe-e71c-45fb-b5ff-0f2ad9546e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c0040>]}
[0m16:56:17.150075 [info ] [MainThread]: 
[0m16:56:17.150465 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:56:17.150957 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m16:56:17.159398 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m16:56:17.159595 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m16:56:17.159762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:17.976610 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:56:17.981013 [debug] [ThreadPool]: On list_iceberg: Close
[0m16:56:17.985146 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_landing)
[0m16:56:17.996100 [debug] [ThreadPool]: Using trino connection "list_iceberg_landing"
[0m16:56:17.996629 [debug] [ThreadPool]: On list_iceberg_landing: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg_landing"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'landing') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'landing'
[0m16:56:17.997011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:56:18.983071 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:56:18.986899 [debug] [ThreadPool]: On list_iceberg_landing: ROLLBACK
[0m16:56:18.987636 [debug] [ThreadPool]: On list_iceberg_landing: Close
[0m16:56:18.993768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24ce2fbe-e71c-45fb-b5ff-0f2ad9546e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10578c6a0>]}
[0m16:56:18.994459 [debug] [MainThread]: On master: COMMIT
[0m16:56:18.995362 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:56:18.995807 [info ] [MainThread]: 
[0m16:56:18.999094 [debug] [Thread-1  ]: Began running node model.dev.postgres_subscription
[0m16:56:18.999652 [info ] [Thread-1  ]: 1 of 1 START sql table model iceberg.landing.postgres_subscription ............. [RUN]
[0m16:56:19.000648 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_landing, now model.dev.postgres_subscription)
[0m16:56:19.001069 [debug] [Thread-1  ]: Began compiling node model.dev.postgres_subscription
[0m16:56:19.005016 [debug] [Thread-1  ]: Writing injected SQL for node "model.dev.postgres_subscription"
[0m16:56:19.006731 [debug] [Thread-1  ]: Timing info for model.dev.postgres_subscription (compile): 16:56:19.001320 => 16:56:19.006494
[0m16:56:19.007114 [debug] [Thread-1  ]: Began executing node model.dev.postgres_subscription
[0m16:56:19.037712 [debug] [Thread-1  ]: Writing runtime sql for node "model.dev.postgres_subscription"
[0m16:56:19.039624 [debug] [Thread-1  ]: Using trino connection "model.dev.postgres_subscription"
[0m16:56:19.039893 [debug] [Thread-1  ]: On model.dev.postgres_subscription: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.postgres_subscription"} */

  
    

    create table "iceberg"."landing"."postgres_subscription__dbt_tmp"
      
      
    as (
      

SELECT
    DISTINCT CAST(
        id AS INT
    ) AS subscription_id,
    plan AS plan,
    status AS status,
    payment_method AS payment_method,
    subscription_term,
    payment_term,
    CAST(
        dt_current_timestamp AS TIMESTAMP
    ) AS last_updated
FROM
    "minio"."landing"."postgres_subscription_parquet"
    )
[0m16:56:19.040143 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:56:21.145494 [debug] [Thread-1  ]: SQL status: SUCCESS in 2.0 seconds
[0m16:56:21.159723 [debug] [Thread-1  ]: Using trino connection "model.dev.postgres_subscription"
[0m16:56:21.160424 [debug] [Thread-1  ]: On model.dev.postgres_subscription: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.postgres_subscription"} */
alter table "iceberg"."landing"."postgres_subscription__dbt_tmp" rename to "iceberg"."landing"."postgres_subscription"
[0m16:56:21.714644 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:56:21.721717 [debug] [Thread-1  ]: Applying DROP to: "iceberg"."landing"."postgres_subscription__dbt_backup"
[0m16:56:21.723492 [debug] [Thread-1  ]: Using trino connection "model.dev.postgres_subscription"
[0m16:56:21.723824 [debug] [Thread-1  ]: On model.dev.postgres_subscription: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.postgres_subscription"} */

    drop table if exists "iceberg"."landing"."postgres_subscription__dbt_backup"
[0m16:56:22.272995 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:56:22.294293 [debug] [Thread-1  ]: Timing info for model.dev.postgres_subscription (execute): 16:56:19.007344 => 16:56:22.294056
[0m16:56:22.294763 [debug] [Thread-1  ]: On model.dev.postgres_subscription: ROLLBACK
[0m16:56:22.295092 [debug] [Thread-1  ]: On model.dev.postgres_subscription: Close
[0m16:56:22.295936 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ce2fbe-e71c-45fb-b5ff-0f2ad9546e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10506e250>]}
[0m16:56:22.296466 [info ] [Thread-1  ]: 1 of 1 OK created sql table model iceberg.landing.postgres_subscription ........ [[32mSUCCESS[0m in 3.30s]
[0m16:56:22.297006 [debug] [Thread-1  ]: Finished running node model.dev.postgres_subscription
[0m16:56:22.298192 [debug] [MainThread]: On master: COMMIT
[0m16:56:22.298798 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:56:22.299080 [debug] [MainThread]: Connection 'model.dev.postgres_subscription' was properly closed.
[0m16:56:22.299375 [info ] [MainThread]: 
[0m16:56:22.299712 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.15 seconds (5.15s).
[0m16:56:22.300283 [debug] [MainThread]: Command end result
[0m16:56:22.308890 [info ] [MainThread]: 
[0m16:56:22.309191 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:56:22.309447 [info ] [MainThread]: 
[0m16:56:22.309703 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:56:22.312099 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.5093803, "process_user_time": 1.494096, "process_kernel_time": 0.16501, "process_mem_max_rss": "119848960", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:56:22.312441 [debug] [MainThread]: Command `cli run` succeeded at 16:56:22.312350 after 5.51 seconds
[0m16:56:22.312713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103265550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105093610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10578c220>]}
[0m16:56:22.312988 [debug] [MainThread]: Flushing usage events
[0m16:56:30.082340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102af0160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e9d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106edc550>]}


============================== 16:56:30.085561 | 89b859ef-eed6-4dd4-be4e-0859af4db2c9 ==============================
[0m16:56:30.085561 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:56:30.085943 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:56:30.208871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89b859ef-eed6-4dd4-be4e-0859af4db2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ecba30>]}
[0m16:56:30.251053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89b859ef-eed6-4dd4-be4e-0859af4db2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070a90a0>]}
[0m16:56:30.251416 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:56:30.262125 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m16:56:30.313886 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:56:30.314232 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:56:30.317687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89b859ef-eed6-4dd4-be4e-0859af4db2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075c2fa0>]}
[0m16:56:30.323871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89b859ef-eed6-4dd4-be4e-0859af4db2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073ee850>]}
[0m16:56:30.324216 [info ] [MainThread]: Found 9 models, 8 sources, 0 exposures, 0 metrics, 423 macros, 0 groups, 0 semantic models
[0m16:56:30.324442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89b859ef-eed6-4dd4-be4e-0859af4db2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073ee9d0>]}
[0m16:56:30.325278 [info ] [MainThread]: 
[0m16:56:30.325744 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:56:30.326314 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m16:56:30.335506 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m16:56:30.335747 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m16:56:30.335926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:31.158327 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:56:31.159836 [debug] [ThreadPool]: On list_iceberg: Close
[0m16:56:31.161555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_landing)
[0m16:56:31.168259 [debug] [ThreadPool]: Using trino connection "list_iceberg_landing"
[0m16:56:31.168635 [debug] [ThreadPool]: On list_iceberg_landing: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg_landing"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'landing') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'landing'
[0m16:56:31.168884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:56:32.117931 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:56:32.120717 [debug] [ThreadPool]: On list_iceberg_landing: ROLLBACK
[0m16:56:32.121203 [debug] [ThreadPool]: On list_iceberg_landing: Close
[0m16:56:32.125484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89b859ef-eed6-4dd4-be4e-0859af4db2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e823d0>]}
[0m16:56:32.125973 [debug] [MainThread]: On master: COMMIT
[0m16:56:32.126653 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:56:32.127002 [info ] [MainThread]: 
[0m16:56:32.130704 [debug] [Thread-1  ]: Began running node model.dev.postgres_vehicle
[0m16:56:32.131221 [info ] [Thread-1  ]: 1 of 1 START sql table model iceberg.landing.postgres_vehicle .................. [RUN]
[0m16:56:32.132145 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_landing, now model.dev.postgres_vehicle)
[0m16:56:32.132503 [debug] [Thread-1  ]: Began compiling node model.dev.postgres_vehicle
[0m16:56:32.136044 [debug] [Thread-1  ]: Writing injected SQL for node "model.dev.postgres_vehicle"
[0m16:56:32.137693 [debug] [Thread-1  ]: Timing info for model.dev.postgres_vehicle (compile): 16:56:32.132716 => 16:56:32.137408
[0m16:56:32.138078 [debug] [Thread-1  ]: Began executing node model.dev.postgres_vehicle
[0m16:56:32.169240 [debug] [Thread-1  ]: Writing runtime sql for node "model.dev.postgres_vehicle"
[0m16:56:32.173136 [debug] [Thread-1  ]: Using trino connection "model.dev.postgres_vehicle"
[0m16:56:32.173502 [debug] [Thread-1  ]: On model.dev.postgres_vehicle: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.postgres_vehicle"} */

  
    

    create table "iceberg"."landing"."postgres_vehicle__dbt_tmp"
      
      
    as (
      

SELECT
    DISTINCT CAST(
        id AS INT
    ) AS vehicle_id,
    user_id AS user_id,
    NAME AS NAME,
    YEAR AS YEAR,
    km_driven AS km_driven,
    fuel AS fuel,
    seller_type AS seller_type,
    transmission AS transmission,
    mileage AS mileage,
    engine AS engine,
    max_power AS max_power,
    torque AS torque,
    CAST(
        seats AS INT
    ) AS seats,
    CAST(
        dt_current_timestamp AS TIMESTAMP
    ) AS last_updated
FROM
    "minio"."landing"."postgres_vehicle_parquet"
    )
[0m16:56:32.173779 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:56:34.601373 [debug] [Thread-1  ]: SQL status: SUCCESS in 2.0 seconds
[0m16:56:34.609471 [debug] [Thread-1  ]: Using trino connection "model.dev.postgres_vehicle"
[0m16:56:34.609921 [debug] [Thread-1  ]: On model.dev.postgres_vehicle: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.postgres_vehicle"} */
alter table "iceberg"."landing"."postgres_vehicle__dbt_tmp" rename to "iceberg"."landing"."postgres_vehicle"
[0m16:56:35.151725 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:56:35.162541 [debug] [Thread-1  ]: Applying DROP to: "iceberg"."landing"."postgres_vehicle__dbt_backup"
[0m16:56:35.194001 [debug] [Thread-1  ]: Using trino connection "model.dev.postgres_vehicle"
[0m16:56:35.194396 [debug] [Thread-1  ]: On model.dev.postgres_vehicle: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.postgres_vehicle"} */

    drop table if exists "iceberg"."landing"."postgres_vehicle__dbt_backup"
[0m16:56:35.740589 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:56:35.759243 [debug] [Thread-1  ]: Timing info for model.dev.postgres_vehicle (execute): 16:56:32.138293 => 16:56:35.759010
[0m16:56:35.759683 [debug] [Thread-1  ]: On model.dev.postgres_vehicle: ROLLBACK
[0m16:56:35.760010 [debug] [Thread-1  ]: On model.dev.postgres_vehicle: Close
[0m16:56:35.760814 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b859ef-eed6-4dd4-be4e-0859af4db2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076646d0>]}
[0m16:56:35.761338 [info ] [Thread-1  ]: 1 of 1 OK created sql table model iceberg.landing.postgres_vehicle ............. [[32mSUCCESS[0m in 3.63s]
[0m16:56:35.761860 [debug] [Thread-1  ]: Finished running node model.dev.postgres_vehicle
[0m16:56:35.762930 [debug] [MainThread]: On master: COMMIT
[0m16:56:35.763468 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:56:35.763720 [debug] [MainThread]: Connection 'model.dev.postgres_vehicle' was properly closed.
[0m16:56:35.763987 [info ] [MainThread]: 
[0m16:56:35.764273 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.44 seconds (5.44s).
[0m16:56:35.764768 [debug] [MainThread]: Command end result
[0m16:56:35.773257 [info ] [MainThread]: 
[0m16:56:35.773563 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:56:35.773827 [info ] [MainThread]: 
[0m16:56:35.774108 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:56:35.776612 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.7328396, "process_user_time": 1.434271, "process_kernel_time": 0.177796, "process_mem_max_rss": "113491968", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:56:35.777002 [debug] [MainThread]: Command `cli run` succeeded at 16:56:35.776905 after 5.73 seconds
[0m16:56:35.777302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102af0160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10765cf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070bd9d0>]}
[0m16:56:35.777603 [debug] [MainThread]: Flushing usage events
[0m16:59:51.126200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114036b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11615d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11619c550>]}


============================== 16:59:51.129616 | 4e783669-9b07-478c-8f58-e90deca8cedd ==============================
[0m16:59:51.129616 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:59:51.129953 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:59:51.252447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e783669-9b07-478c-8f58-e90deca8cedd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1162ca250>]}
[0m16:59:51.294222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e783669-9b07-478c-8f58-e90deca8cedd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1163690a0>]}
[0m16:59:51.294574 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:59:51.306201 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m16:59:51.307931 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:59:51.308224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4e783669-9b07-478c-8f58-e90deca8cedd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11646d310>]}
[0m16:59:51.900198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e783669-9b07-478c-8f58-e90deca8cedd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1169a00d0>]}
[0m16:59:51.908988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e783669-9b07-478c-8f58-e90deca8cedd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11696c880>]}
[0m16:59:51.909375 [info ] [MainThread]: Found 9 models, 8 sources, 0 exposures, 0 metrics, 423 macros, 0 groups, 0 semantic models
[0m16:59:51.909612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e783669-9b07-478c-8f58-e90deca8cedd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116458ca0>]}
[0m16:59:51.910421 [info ] [MainThread]: 
[0m16:59:51.910902 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:59:51.911530 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m16:59:51.921257 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m16:59:51.921533 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m16:59:51.921726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:52.752746 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:59:52.754530 [debug] [ThreadPool]: On list_iceberg: Close
[0m16:59:52.757487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_landing)
[0m16:59:52.766375 [debug] [ThreadPool]: Using trino connection "list_iceberg_landing"
[0m16:59:52.766799 [debug] [ThreadPool]: On list_iceberg_landing: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg_landing"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'landing') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'landing'
[0m16:59:52.767126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:59:53.729822 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:59:53.734513 [debug] [ThreadPool]: On list_iceberg_landing: ROLLBACK
[0m16:59:53.735270 [debug] [ThreadPool]: On list_iceberg_landing: Close
[0m16:59:53.741963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e783669-9b07-478c-8f58-e90deca8cedd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1169adca0>]}
[0m16:59:53.742905 [debug] [MainThread]: On master: COMMIT
[0m16:59:53.743739 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:59:53.744142 [info ] [MainThread]: 
[0m16:59:53.748326 [debug] [Thread-1  ]: Began running node model.dev.users
[0m16:59:53.748824 [info ] [Thread-1  ]: 1 of 1 START sql view model iceberg.landing.users .............................. [RUN]
[0m16:59:53.749529 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_landing, now model.dev.users)
[0m16:59:53.749911 [debug] [Thread-1  ]: Began compiling node model.dev.users
[0m16:59:53.753982 [debug] [Thread-1  ]: Writing injected SQL for node "model.dev.users"
[0m16:59:53.756223 [debug] [Thread-1  ]: Timing info for model.dev.users (compile): 16:59:53.750150 => 16:59:53.755972
[0m16:59:53.756586 [debug] [Thread-1  ]: Began executing node model.dev.users
[0m16:59:53.774061 [debug] [Thread-1  ]: Writing runtime sql for node "model.dev.users"
[0m16:59:53.777347 [debug] [Thread-1  ]: Using trino connection "model.dev.users"
[0m16:59:53.777655 [debug] [Thread-1  ]: On model.dev.users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.users"} */

  create or replace view
    "iceberg"."landing"."users"
  security definer
  as
    

WITH mssql_users AS (
    SELECT *, ROW_NUMBER() OVER (ORDER BY last_updated) AS rwn_id
    FROM "iceberg"."landing"."mssql_users"
),
mongodb_users AS (
    SELECT *, ROW_NUMBER() OVER (ORDER BY last_updated) AS rwn_id
    FROM "iceberg"."landing"."mongodb_users"
)
SELECT DISTINCT 
    mssql.rwn_id AS user_id,
    mssql.cpf AS cpf,
    mssql.full_name AS full_name,
    mssql.date_of_birth AS date_of_birth,
    mssql.city AS city,
    mssql.country AS country
FROM mssql_users AS mssql
INNER JOIN mongodb_users AS mongodb
ON mssql.user_id = mongodb.user_id
  
[0m16:59:53.777940 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:59:54.455909 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:59:54.470540 [debug] [Thread-1  ]: Timing info for model.dev.users (execute): 16:59:53.756794 => 16:59:54.470354
[0m16:59:54.470889 [debug] [Thread-1  ]: On model.dev.users: ROLLBACK
[0m16:59:54.471172 [debug] [Thread-1  ]: On model.dev.users: Close
[0m16:59:54.471868 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e783669-9b07-478c-8f58-e90deca8cedd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116aecd60>]}
[0m16:59:54.472306 [info ] [Thread-1  ]: 1 of 1 OK created sql view model iceberg.landing.users ......................... [[32mSUCCESS[0m in 0.72s]
[0m16:59:54.472766 [debug] [Thread-1  ]: Finished running node model.dev.users
[0m16:59:54.473765 [debug] [MainThread]: On master: COMMIT
[0m16:59:54.474305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:54.474554 [debug] [MainThread]: Connection 'model.dev.users' was properly closed.
[0m16:59:54.474814 [info ] [MainThread]: 
[0m16:59:54.475095 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.56 seconds (2.56s).
[0m16:59:54.475597 [debug] [MainThread]: Command end result
[0m16:59:54.483373 [info ] [MainThread]: 
[0m16:59:54.483670 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:59:54.483891 [info ] [MainThread]: 
[0m16:59:54.484128 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:59:54.486569 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.3984594, "process_user_time": 1.865838, "process_kernel_time": 0.192145, "process_mem_max_rss": "117669888", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:59:54.486904 [debug] [MainThread]: Command `cli run` succeeded at 16:59:54.486821 after 3.40 seconds
[0m16:59:54.487161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114036b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b3ae20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116359580>]}
[0m16:59:54.487429 [debug] [MainThread]: Flushing usage events
[0m17:02:27.335144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f74250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b468e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b58340>]}


============================== 17:02:27.338149 | ce010c53-ecbb-4efb-b2fc-daad424d07dd ==============================
[0m17:02:27.338149 [info ] [MainThread]: Running with dbt=1.7.8
[0m17:02:27.338491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m17:02:27.459423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce010c53-ecbb-4efb-b2fc-daad424d07dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b2f2b0>]}
[0m17:02:27.500667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce010c53-ecbb-4efb-b2fc-daad424d07dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a22940>]}
[0m17:02:27.500972 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m17:02:27.513299 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m17:02:27.565269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:02:27.565722 [debug] [MainThread]: Partial parsing: added file: dev://models/trusted/ride_transactions.sql
[0m17:02:27.627636 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dev.ride_transactions' (models/trusted/ride_transactions.sql) depends on a node named 'stage_mongodb_rides' which was not found
[0m17:02:27.630240 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.33090666, "process_user_time": 1.217507, "process_kernel_time": 0.16678, "process_mem_max_rss": "107692032", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:02:27.630631 [debug] [MainThread]: Command `cli run` failed at 17:02:27.630535 after 0.33 seconds
[0m17:02:27.630860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f74250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10711a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107073f10>]}
[0m17:02:27.631081 [debug] [MainThread]: Flushing usage events
[0m17:03:27.877926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e8160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083799a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083b8550>]}


============================== 17:03:27.881194 | c804ee0b-9be6-4e3c-9ed7-ceff186fac94 ==============================
[0m17:03:27.881194 [info ] [MainThread]: Running with dbt=1.7.8
[0m17:03:27.881532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m17:03:28.002650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c804ee0b-9be6-4e3c-9ed7-ceff186fac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083a6a30>]}
[0m17:03:28.044621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c804ee0b-9be6-4e3c-9ed7-ceff186fac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085850a0>]}
[0m17:03:28.044980 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m17:03:28.055700 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m17:03:28.104347 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:03:28.104609 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:03:28.108410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c804ee0b-9be6-4e3c-9ed7-ceff186fac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10889e0d0>]}
[0m17:03:28.114974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c804ee0b-9be6-4e3c-9ed7-ceff186fac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10886bd60>]}
[0m17:03:28.115271 [info ] [MainThread]: Found 10 models, 8 sources, 0 exposures, 0 metrics, 423 macros, 0 groups, 0 semantic models
[0m17:03:28.115541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c804ee0b-9be6-4e3c-9ed7-ceff186fac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087b30d0>]}
[0m17:03:28.116328 [info ] [MainThread]: 
[0m17:03:28.116758 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:03:28.117335 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m17:03:28.126355 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m17:03:28.126579 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m17:03:28.126754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:29.085374 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:03:29.086998 [debug] [ThreadPool]: On list_iceberg: Close
[0m17:03:29.089040 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_landing)
[0m17:03:29.096381 [debug] [ThreadPool]: Using trino connection "list_iceberg_landing"
[0m17:03:29.096786 [debug] [ThreadPool]: On list_iceberg_landing: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg_landing"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'landing') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'landing'
[0m17:03:29.097079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:03:30.049353 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:03:30.052678 [debug] [ThreadPool]: On list_iceberg_landing: ROLLBACK
[0m17:03:30.053269 [debug] [ThreadPool]: On list_iceberg_landing: Close
[0m17:03:30.059629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c804ee0b-9be6-4e3c-9ed7-ceff186fac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10835ed00>]}
[0m17:03:30.060079 [debug] [MainThread]: On master: COMMIT
[0m17:03:30.060765 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:03:30.061205 [info ] [MainThread]: 
[0m17:03:30.065098 [debug] [Thread-1  ]: Began running node model.dev.ride_transactions
[0m17:03:30.065686 [info ] [Thread-1  ]: 1 of 1 START sql view model iceberg.landing.ride_transactions .................. [RUN]
[0m17:03:30.066446 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_landing, now model.dev.ride_transactions)
[0m17:03:30.066860 [debug] [Thread-1  ]: Began compiling node model.dev.ride_transactions
[0m17:03:30.071442 [debug] [Thread-1  ]: Writing injected SQL for node "model.dev.ride_transactions"
[0m17:03:30.072938 [debug] [Thread-1  ]: Timing info for model.dev.ride_transactions (compile): 17:03:30.067103 => 17:03:30.072610
[0m17:03:30.073383 [debug] [Thread-1  ]: Began executing node model.dev.ride_transactions
[0m17:03:30.090364 [debug] [Thread-1  ]: Writing runtime sql for node "model.dev.ride_transactions"
[0m17:03:30.094644 [debug] [Thread-1  ]: Using trino connection "model.dev.ride_transactions"
[0m17:03:30.095024 [debug] [Thread-1  ]: On model.dev.ride_transactions: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.ride_transactions"} */

  create or replace view
    "iceberg"."landing"."ride_transactions"
  security definer
  as
    

WITH user AS (
    SELECT *
    FROM "iceberg"."landing"."users"
),
vehicle AS (
    SELECT * 
    FROM "iceberg"."landing"."postgres_vehicle"
),
subscription AS (
    SELECT * 
    FROM "iceberg"."landing"."postgres_subscription"
),
stripe AS (
    SELECT * 
    FROM "iceberg"."landing"."mongodb_stripe"
),
payment AS (
    SELECT * 
    FROM "iceberg"."landing"."postgres_payments"
)
SELECT rides.ride_id AS ride_id,
    rides.user_id AS user_id,
    rides.vehicle_id AS vehicle_id,
    rides.subscription_id AS subscription_id,
    rides.stripe_id AS stripe_id,
    rides.payment_id AS payment_id,
    user.full_name AS user_full_name,
    user.cpf AS user_cpf,
    rides.source AS source,
    rides.destination AS destination,
    rides.estimated_price AS estimated_price,
    rides.surge_multiplier AS dynamic_fare,
    rides.price AS price,
    vehicle.name AS vehicle_name,
    vehicle.year AS vehicle_year,
    vehicle.km_driven AS vehicle_km_driven,
    vehicle.seats AS vehicle_seats,
    subscription.plan AS subscription_plan,
    subscription.status AS subscription_status,
    subscription.payment_method AS subscription_payment_method,
    stripe.identifier AS stripe_identifier,
    stripe.card_type AS stripe_card_type,
    payment.city AS payment_city,
    payment.country AS payment_country,
    payment.currency AS payment_currency,
    payment.credit_card_type AS payment_credit_card_type,
    payment.price AS payment_price
FROM "iceberg"."landing"."mongodb_rides" AS rides
LEFT OUTER JOIN user AS user
ON rides.user_id = user.user_id
LEFT OUTER JOIN vehicle AS vehicle
ON rides.vehicle_id = vehicle.vehicle_id
LEFT OUTER JOIN subscription AS subscription
ON rides.subscription_id = subscription.subscription_id
LEFT OUTER JOIN stripe AS stripe
ON rides.stripe_id = stripe.stripe_id
LEFT OUTER JOIN payment AS payment
ON rides.payment_id = payment.payment_id
  
[0m17:03:30.095364 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:03:31.115133 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m17:03:31.138051 [debug] [Thread-1  ]: Timing info for model.dev.ride_transactions (execute): 17:03:30.073631 => 17:03:31.137817
[0m17:03:31.138534 [debug] [Thread-1  ]: On model.dev.ride_transactions: ROLLBACK
[0m17:03:31.138865 [debug] [Thread-1  ]: On model.dev.ride_transactions: Close
[0m17:03:31.139752 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c804ee0b-9be6-4e3c-9ed7-ceff186fac94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10835ed00>]}
[0m17:03:31.140326 [info ] [Thread-1  ]: 1 of 1 OK created sql view model iceberg.landing.ride_transactions ............. [[32mSUCCESS[0m in 1.07s]
[0m17:03:31.140867 [debug] [Thread-1  ]: Finished running node model.dev.ride_transactions
[0m17:03:31.142099 [debug] [MainThread]: On master: COMMIT
[0m17:03:31.142711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:31.143018 [debug] [MainThread]: Connection 'model.dev.ride_transactions' was properly closed.
[0m17:03:31.143319 [info ] [MainThread]: 
[0m17:03:31.143636 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.03 seconds (3.03s).
[0m17:03:31.144174 [debug] [MainThread]: Command end result
[0m17:03:31.181471 [info ] [MainThread]: 
[0m17:03:31.181825 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:03:31.182035 [info ] [MainThread]: 
[0m17:03:31.182256 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:03:31.184895 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.3419497, "process_user_time": 1.343343, "process_kernel_time": 0.182514, "process_mem_max_rss": "111706112", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:03:31.185194 [debug] [MainThread]: Command `cli run` succeeded at 17:03:31.185116 after 3.34 seconds
[0m17:03:31.185434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e8160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086ae1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108663310>]}
[0m17:03:31.185676 [debug] [MainThread]: Flushing usage events
[0m17:05:07.882449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc4dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b3a610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b94f10>]}


============================== 17:05:07.885270 | 8ee052a5-3c9e-49ff-88c8-021c84ba8a49 ==============================
[0m17:05:07.885270 [info ] [MainThread]: Running with dbt=1.7.8
[0m17:05:07.885599 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:05:08.005972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ee052a5-3c9e-49ff-88c8-021c84ba8a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b2cfd0>]}
[0m17:05:08.048143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ee052a5-3c9e-49ff-88c8-021c84ba8a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e9b730>]}
[0m17:05:08.048494 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m17:05:08.059364 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m17:05:08.115030 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:05:08.115567 [debug] [MainThread]: Partial parsing: updated file: dev://models/trusted/ride_transactions.sql
[0m17:05:08.182743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ee052a5-3c9e-49ff-88c8-021c84ba8a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091960d0>]}
[0m17:05:08.210923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ee052a5-3c9e-49ff-88c8-021c84ba8a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10906d940>]}
[0m17:05:08.211196 [info ] [MainThread]: Found 10 models, 8 sources, 0 exposures, 0 metrics, 423 macros, 0 groups, 0 semantic models
[0m17:05:08.211408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ee052a5-3c9e-49ff-88c8-021c84ba8a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109109880>]}
[0m17:05:08.212040 [info ] [MainThread]: 
[0m17:05:08.212431 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:05:08.212993 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m17:05:08.221571 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m17:05:08.221778 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m17:05:08.221946 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:09.529495 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:05:09.532895 [debug] [ThreadPool]: On list_iceberg: Close
[0m17:05:09.537044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_landing)
[0m17:05:09.545105 [debug] [ThreadPool]: Using trino connection "list_iceberg_landing"
[0m17:05:09.545575 [debug] [ThreadPool]: On list_iceberg_landing: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg_landing"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'landing') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'landing'
[0m17:05:09.545902 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:05:10.513549 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:05:10.521071 [debug] [ThreadPool]: On list_iceberg_landing: ROLLBACK
[0m17:05:10.522210 [debug] [ThreadPool]: On list_iceberg_landing: Close
[0m17:05:10.532927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ee052a5-3c9e-49ff-88c8-021c84ba8a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091668b0>]}
[0m17:05:10.533940 [debug] [MainThread]: On master: COMMIT
[0m17:05:10.535444 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:05:10.536138 [info ] [MainThread]: 
[0m17:05:10.541489 [debug] [Thread-1  ]: Began running node model.dev.ride_transactions
[0m17:05:10.542608 [info ] [Thread-1  ]: 1 of 1 START sql view model iceberg.landing.ride_transactions .................. [RUN]
[0m17:05:10.544047 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_landing, now model.dev.ride_transactions)
[0m17:05:10.544710 [debug] [Thread-1  ]: Began compiling node model.dev.ride_transactions
[0m17:05:10.552095 [debug] [Thread-1  ]: Writing injected SQL for node "model.dev.ride_transactions"
[0m17:05:10.554084 [debug] [Thread-1  ]: Timing info for model.dev.ride_transactions (compile): 17:05:10.545087 => 17:05:10.553815
[0m17:05:10.554498 [debug] [Thread-1  ]: Began executing node model.dev.ride_transactions
[0m17:05:10.574657 [debug] [Thread-1  ]: Writing runtime sql for node "model.dev.ride_transactions"
[0m17:05:10.579436 [debug] [Thread-1  ]: Using trino connection "model.dev.ride_transactions"
[0m17:05:10.579830 [debug] [Thread-1  ]: On model.dev.ride_transactions: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.ride_transactions"} */

  create or replace view
    "iceberg"."landing"."ride_transactions"
  security definer
  as
    

WITH user AS (

    SELECT
        *
    FROM
        "iceberg"."landing"."users"
),
vehicle AS (
    SELECT
        *
    FROM
        "iceberg"."landing"."postgres_vehicle"
),
subscription AS (
    SELECT
        *
    FROM
        "iceberg"."landing"."postgres_subscription"
),
stripe AS (
    SELECT
        *
    FROM
        "iceberg"."landing"."mongodb_stripe"
),
payment AS (
    SELECT
        *
    FROM
        "iceberg"."landing"."postgres_payments"
)
SELECT
    rides.ride_id AS ride_id,
    rides.user_id AS user_id,
    rides.vehicle_id AS vehicle_id,
    rides.subscription_id AS subscription_id,
    rides.stripe_id AS stripe_id,
    rides.payment_id AS payment_id,
    user.full_name AS user_full_name,
    user.cpf AS user_cpf,
    rides.source AS source,
    rides.destination AS destination,
    rides.estimated_price AS estimated_price,
    rides.surge_multiplier AS dynamic_fare,
    rides.price AS price,
    vehicle.name AS vehicle_name,
    vehicle.year AS vehicle_year,
    vehicle.km_driven AS vehicle_km_driven,
    vehicle.seats AS vehicle_seats,
    subscription.plan AS subscription_plan,
    subscription.status AS subscription_status,
    subscription.payment_method AS subscription_payment_method,
    stripe.identifier AS stripe_identifier,
    stripe.card_type AS stripe_card_type,
    payment.city AS payment_city,
    payment.country AS payment_country,
    payment.currency AS payment_currency,
    payment.credit_card_type AS payment_credit_card_type,
    payment.price AS payment_price
FROM
    "iceberg"."landing"."mongodb_rides" AS rides
    LEFT OUTER JOIN USER AS USER
    ON rides.user_id = USER.user_id
    LEFT OUTER JOIN vehicle AS vehicle
    ON rides.vehicle_id = vehicle.vehicle_id
    LEFT OUTER JOIN subscription AS subscription
    ON rides.subscription_id = subscription.subscription_id
    LEFT OUTER JOIN stripe AS stripe
    ON rides.stripe_id = stripe.stripe_id
    LEFT OUTER JOIN payment AS payment
    ON rides.payment_id = payment.payment_id
  
[0m17:05:10.580165 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:05:11.443612 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m17:05:11.475549 [debug] [Thread-1  ]: Timing info for model.dev.ride_transactions (execute): 17:05:10.554742 => 17:05:11.475241
[0m17:05:11.476188 [debug] [Thread-1  ]: On model.dev.ride_transactions: ROLLBACK
[0m17:05:11.476638 [debug] [Thread-1  ]: On model.dev.ride_transactions: Close
[0m17:05:11.477776 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ee052a5-3c9e-49ff-88c8-021c84ba8a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091780d0>]}
[0m17:05:11.478389 [info ] [Thread-1  ]: 1 of 1 OK created sql view model iceberg.landing.ride_transactions ............. [[32mSUCCESS[0m in 0.93s]
[0m17:05:11.478978 [debug] [Thread-1  ]: Finished running node model.dev.ride_transactions
[0m17:05:11.480748 [debug] [MainThread]: On master: COMMIT
[0m17:05:11.481643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:05:11.481973 [debug] [MainThread]: Connection 'model.dev.ride_transactions' was properly closed.
[0m17:05:11.482352 [info ] [MainThread]: 
[0m17:05:11.482769 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.27 seconds (3.27s).
[0m17:05:11.483490 [debug] [MainThread]: Command end result
[0m17:05:11.494907 [info ] [MainThread]: 
[0m17:05:11.495463 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:05:11.495788 [info ] [MainThread]: 
[0m17:05:11.496126 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:05:11.499117 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.655866, "process_user_time": 1.447381, "process_kernel_time": 0.17263, "process_mem_max_rss": "114278400", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:05:11.499617 [debug] [MainThread]: Command `cli run` succeeded at 17:05:11.499498 after 3.66 seconds
[0m17:05:11.500032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc4dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109280610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091668e0>]}
[0m17:05:11.500433 [debug] [MainThread]: Flushing usage events
[0m17:06:36.379619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b69dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109afe610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b58f10>]}


============================== 17:06:36.382375 | b3b17b73-d5be-4eea-85fd-cf81000f495c ==============================
[0m17:06:36.382375 [info ] [MainThread]: Running with dbt=1.7.8
[0m17:06:36.382709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:06:36.501490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3b17b73-d5be-4eea-85fd-cf81000f495c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109af0fd0>]}
[0m17:06:36.542866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3b17b73-d5be-4eea-85fd-cf81000f495c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e5e730>]}
[0m17:06:36.543174 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m17:06:36.553832 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m17:06:36.555367 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:06:36.555589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b3b17b73-d5be-4eea-85fd-cf81000f495c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e5e6d0>]}
[0m17:06:37.136965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3b17b73-d5be-4eea-85fd-cf81000f495c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a363940>]}
[0m17:06:37.143768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3b17b73-d5be-4eea-85fd-cf81000f495c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0deb20>]}
[0m17:06:37.144000 [info ] [MainThread]: Found 10 models, 8 sources, 0 exposures, 0 metrics, 423 macros, 0 groups, 0 semantic models
[0m17:06:37.144206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3b17b73-d5be-4eea-85fd-cf81000f495c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109db2eb0>]}
[0m17:06:37.144859 [info ] [MainThread]: 
[0m17:06:37.145249 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:06:37.145741 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m17:06:37.154094 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m17:06:37.154295 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m17:06:37.154462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:37.983041 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:06:37.984615 [debug] [ThreadPool]: On list_iceberg: Close
[0m17:06:37.986713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_landing)
[0m17:06:37.994372 [debug] [ThreadPool]: Using trino connection "list_iceberg_landing"
[0m17:06:37.994729 [debug] [ThreadPool]: On list_iceberg_landing: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg_landing"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'landing') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'landing'
[0m17:06:37.995016 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:06:38.950565 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:06:38.954934 [debug] [ThreadPool]: On list_iceberg_landing: ROLLBACK
[0m17:06:38.955689 [debug] [ThreadPool]: On list_iceberg_landing: Close
[0m17:06:38.962098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3b17b73-d5be-4eea-85fd-cf81000f495c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a36d070>]}
[0m17:06:38.962946 [debug] [MainThread]: On master: COMMIT
[0m17:06:38.963744 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:06:38.964135 [info ] [MainThread]: 
[0m17:06:38.967332 [debug] [Thread-1  ]: Began running node model.dev.ride_transactions
[0m17:06:38.967892 [info ] [Thread-1  ]: 1 of 1 START sql view model iceberg.landing.ride_transactions .................. [RUN]
[0m17:06:38.968639 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_landing, now model.dev.ride_transactions)
[0m17:06:38.969266 [debug] [Thread-1  ]: Began compiling node model.dev.ride_transactions
[0m17:06:38.973827 [debug] [Thread-1  ]: Writing injected SQL for node "model.dev.ride_transactions"
[0m17:06:38.975666 [debug] [Thread-1  ]: Timing info for model.dev.ride_transactions (compile): 17:06:38.969512 => 17:06:38.975461
[0m17:06:38.975994 [debug] [Thread-1  ]: Began executing node model.dev.ride_transactions
[0m17:06:38.992864 [debug] [Thread-1  ]: Writing runtime sql for node "model.dev.ride_transactions"
[0m17:06:38.998129 [debug] [Thread-1  ]: Using trino connection "model.dev.ride_transactions"
[0m17:06:38.998501 [debug] [Thread-1  ]: On model.dev.ride_transactions: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.ride_transactions"} */

  create or replace view
    "iceberg"."landing"."ride_transactions"
  security definer
  as
    

WITH user AS (

    SELECT
        *
    FROM
        "iceberg"."landing"."users"
),
vehicle AS (
    SELECT
        *
    FROM
        "iceberg"."landing"."postgres_vehicle"
),
subscription AS (
    SELECT
        *
    FROM
        "iceberg"."landing"."postgres_subscription"
),
stripe AS (
    SELECT
        *
    FROM
        "iceberg"."landing"."mongodb_stripe"
),
payment AS (
    SELECT
        *
    FROM
        "iceberg"."landing"."postgres_payments"
)
SELECT
    rides.ride_id AS ride_id,
    rides.user_id AS user_id,
    rides.vehicle_id AS vehicle_id,
    rides.subscription_id AS subscription_id,
    rides.stripe_id AS stripe_id,
    rides.payment_id AS payment_id,
    user.full_name AS user_full_name,
    user.cpf AS user_cpf,
    rides.source AS source,
    rides.destination AS destination,
    rides.estimated_price AS estimated_price,
    rides.surge_multiplier AS dynamic_fare,
    rides.price AS price,
    vehicle.name AS vehicle_name,
    vehicle.year AS vehicle_year,
    vehicle.km_driven AS vehicle_km_driven,
    vehicle.seats AS vehicle_seats,
    subscription.plan AS subscription_plan,
    subscription.status AS subscription_status,
    subscription.payment_method AS subscription_payment_method,
    stripe.identifier AS stripe_identifier,
    stripe.card_type AS stripe_card_type,
    payment.city AS payment_city,
    payment.country AS payment_country,
    payment.currency AS payment_currency,
    payment.credit_card_type AS payment_credit_card_type,
    payment.price AS payment_price
FROM
    "iceberg"."landing"."mongodb_rides" AS rides
    LEFT OUTER JOIN USER AS USER
    ON rides.user_id = USER.user_id
    LEFT OUTER JOIN vehicle AS vehicle
    ON rides.vehicle_id = vehicle.vehicle_id
    LEFT OUTER JOIN subscription AS subscription
    ON rides.subscription_id = subscription.subscription_id
    LEFT OUTER JOIN stripe AS stripe
    ON rides.stripe_id = stripe.stripe_id
    LEFT OUTER JOIN payment AS payment
    ON rides.payment_id = payment.payment_id
  
[0m17:06:38.998815 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:06:39.711108 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m17:06:39.730676 [debug] [Thread-1  ]: Timing info for model.dev.ride_transactions (execute): 17:06:38.976193 => 17:06:39.730446
[0m17:06:39.731151 [debug] [Thread-1  ]: On model.dev.ride_transactions: ROLLBACK
[0m17:06:39.731485 [debug] [Thread-1  ]: On model.dev.ride_transactions: Close
[0m17:06:39.732306 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3b17b73-d5be-4eea-85fd-cf81000f495c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a47bbb0>]}
[0m17:06:39.732793 [info ] [Thread-1  ]: 1 of 1 OK created sql view model iceberg.landing.ride_transactions ............. [[32mSUCCESS[0m in 0.76s]
[0m17:06:39.733277 [debug] [Thread-1  ]: Finished running node model.dev.ride_transactions
[0m17:06:39.734370 [debug] [MainThread]: On master: COMMIT
[0m17:06:39.734903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:39.735157 [debug] [MainThread]: Connection 'model.dev.ride_transactions' was properly closed.
[0m17:06:39.735423 [info ] [MainThread]: 
[0m17:06:39.735716 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.59 seconds (2.59s).
[0m17:06:39.736224 [debug] [MainThread]: Command end result
[0m17:06:39.745780 [info ] [MainThread]: 
[0m17:06:39.746084 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:06:39.746328 [info ] [MainThread]: 
[0m17:06:39.746591 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:06:39.749490 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.4061217, "process_user_time": 1.842265, "process_kernel_time": 0.174261, "process_mem_max_rss": "119619584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:06:39.749872 [debug] [MainThread]: Command `cli run` succeeded at 17:06:39.749780 after 3.41 seconds
[0m17:06:39.750168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b69dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4fb6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1b6610>]}
[0m17:06:39.750456 [debug] [MainThread]: Flushing usage events
[0m16:31:50.315433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab13400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ef70c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ef5ec70>]}


============================== 16:31:50.319432 | 9d171808-8172-4fca-b7ba-e12bed14a644 ==============================
[0m16:31:50.319432 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:31:50.319787 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:31:50.515303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d171808-8172-4fca-b7ba-e12bed14a644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a5d6a30>]}
[0m16:31:50.563984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d171808-8172-4fca-b7ba-e12bed14a644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f0a7d00>]}
[0m16:31:50.564393 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:31:50.580594 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m16:31:50.967753 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m16:31:50.968415 [debug] [MainThread]: Partial parsing: added file: dev://models/trusted/top_vehicles.sql
[0m16:31:50.968685 [debug] [MainThread]: Partial parsing: added file: dev://models/trusted/total_transactions_per_country.sql
[0m16:31:50.968952 [debug] [MainThread]: Partial parsing: added file: dev://models/trusted/most_used_payment_methods.sql
[0m16:31:51.042218 [debug] [MainThread]: 1699: static parser successfully parsed trusted/top_vehicles.sql
[0m16:31:51.051694 [debug] [MainThread]: 1699: static parser successfully parsed trusted/total_transactions_per_country.sql
[0m16:31:51.053777 [debug] [MainThread]: 1699: static parser successfully parsed trusted/most_used_payment_methods.sql
[0m16:31:51.062742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d171808-8172-4fca-b7ba-e12bed14a644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f5be0d0>]}
[0m16:31:51.100530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d171808-8172-4fca-b7ba-e12bed14a644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f37b9d0>]}
[0m16:31:51.100947 [info ] [MainThread]: Found 13 models, 8 sources, 0 exposures, 0 metrics, 423 macros, 0 groups, 0 semantic models
[0m16:31:51.101207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d171808-8172-4fca-b7ba-e12bed14a644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f37ba00>]}
[0m16:31:51.102163 [info ] [MainThread]: 
[0m16:31:51.102654 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:31:51.103294 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m16:31:51.113350 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m16:31:51.113577 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m16:31:51.113753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:52.107218 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:31:52.111404 [debug] [ThreadPool]: On list_iceberg: Close
[0m16:31:52.114358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now create_iceberg_landing)
[0m16:31:52.115503 [debug] [ThreadPool]: Creating schema "database: "iceberg"
schema: "landing"
"
[0m16:31:52.123296 [debug] [ThreadPool]: Using trino connection "create_iceberg_landing"
[0m16:31:52.123980 [debug] [ThreadPool]: On create_iceberg_landing: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "create_iceberg_landing"} */
create schema if not exists "iceberg"."landing"
[0m16:31:52.124412 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:53.206566 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:31:53.207534 [debug] [ThreadPool]: On create_iceberg_landing: COMMIT
[0m16:31:53.207869 [debug] [ThreadPool]: On create_iceberg_landing: Close
[0m16:31:53.209885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_iceberg_landing, now list_iceberg_landing)
[0m16:31:53.216005 [debug] [ThreadPool]: Using trino connection "list_iceberg_landing"
[0m16:31:53.216476 [debug] [ThreadPool]: On list_iceberg_landing: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg_landing"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'landing') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'landing'
[0m16:31:53.216763 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:54.347058 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:31:54.347884 [debug] [ThreadPool]: On list_iceberg_landing: ROLLBACK
[0m16:31:54.348077 [debug] [ThreadPool]: On list_iceberg_landing: Close
[0m16:31:54.348615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d171808-8172-4fca-b7ba-e12bed14a644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f0895b0>]}
[0m16:31:54.348947 [debug] [MainThread]: On master: COMMIT
[0m16:31:54.349339 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:31:54.349540 [info ] [MainThread]: 
[0m16:31:54.354813 [debug] [Thread-1  ]: Began running node model.dev.mssql_users
[0m16:31:54.355138 [info ] [Thread-1  ]: 1 of 1 START sql table model iceberg.landing.mssql_users ....................... [RUN]
[0m16:31:54.355537 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_landing, now model.dev.mssql_users)
[0m16:31:54.355743 [debug] [Thread-1  ]: Began compiling node model.dev.mssql_users
[0m16:31:54.357993 [debug] [Thread-1  ]: Writing injected SQL for node "model.dev.mssql_users"
[0m16:31:54.358854 [debug] [Thread-1  ]: Timing info for model.dev.mssql_users (compile): 16:31:54.355869 => 16:31:54.358681
[0m16:31:54.359095 [debug] [Thread-1  ]: Began executing node model.dev.mssql_users
[0m16:31:54.380724 [debug] [Thread-1  ]: Writing runtime sql for node "model.dev.mssql_users"
[0m16:31:54.382546 [debug] [Thread-1  ]: Using trino connection "model.dev.mssql_users"
[0m16:31:54.382771 [debug] [Thread-1  ]: On model.dev.mssql_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mssql_users"} */

  
    

    create table "iceberg"."landing"."mssql_users__dbt_tmp"
      
      
    as (
      

SELECT
    DISTINCT CAST(
        user_id AS INT
    ) AS user_id,
    cpf AS cpf,
    CONCAT(
        first_name,
        ' ',
        last_name
    ) AS full_name,
    CAST(
        date_birth AS DATE
    ) AS date_of_birth,
    city AS city,
    country AS country,
    company_name AS company_name,
    job AS job,
    phone_number AS phone_number,
    time_zone AS time_zone,
    CAST(
        dt_current_timestamp AS TIMESTAMP
    ) AS last_updated
FROM
    "minio"."landing"."mssql_users_parquet"
    )
[0m16:31:54.382979 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:32:26.690744 [debug] [Thread-1  ]: SQL status: SUCCESS in 32.0 seconds
[0m16:32:26.701108 [debug] [Thread-1  ]: Using trino connection "model.dev.mssql_users"
[0m16:32:26.701581 [debug] [Thread-1  ]: On model.dev.mssql_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mssql_users"} */
alter table "iceberg"."landing"."mssql_users__dbt_tmp" rename to "iceberg"."landing"."mssql_users"
[0m16:32:28.093723 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:32:28.113564 [debug] [Thread-1  ]: Applying DROP to: "iceberg"."landing"."mssql_users__dbt_backup"
[0m16:32:28.115101 [debug] [Thread-1  ]: Using trino connection "model.dev.mssql_users"
[0m16:32:28.115370 [debug] [Thread-1  ]: On model.dev.mssql_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mssql_users"} */

    drop table if exists "iceberg"."landing"."mssql_users__dbt_backup"
[0m16:32:28.658537 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:32:28.667060 [debug] [Thread-1  ]: Timing info for model.dev.mssql_users (execute): 16:31:54.359224 => 16:32:28.666933
[0m16:32:28.667305 [debug] [Thread-1  ]: On model.dev.mssql_users: ROLLBACK
[0m16:32:28.667499 [debug] [Thread-1  ]: On model.dev.mssql_users: Close
[0m16:32:28.668067 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d171808-8172-4fca-b7ba-e12bed14a644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f7568b0>]}
[0m16:32:28.668411 [info ] [Thread-1  ]: 1 of 1 OK created sql table model iceberg.landing.mssql_users .................. [[32mSUCCESS[0m in 34.31s]
[0m16:32:28.668724 [debug] [Thread-1  ]: Finished running node model.dev.mssql_users
[0m16:32:28.669474 [debug] [MainThread]: On master: COMMIT
[0m16:32:28.669871 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:32:28.670052 [debug] [MainThread]: Connection 'model.dev.mssql_users' was properly closed.
[0m16:32:28.670233 [info ] [MainThread]: 
[0m16:32:28.670450 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 37.57 seconds (37.57s).
[0m16:32:28.670816 [debug] [MainThread]: Command end result
[0m16:32:28.687008 [info ] [MainThread]: 
[0m16:32:28.687347 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:32:28.687559 [info ] [MainThread]: 
[0m16:32:28.687803 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:32:28.698545 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 38.472855, "process_user_time": 1.762763, "process_kernel_time": 0.279198, "process_mem_max_rss": "124272640", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:32:28.698999 [debug] [MainThread]: Command `cli run` succeeded at 16:32:28.698925 after 38.47 seconds
[0m16:32:28.699243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab13400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f350100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f081f10>]}
[0m16:32:28.699504 [debug] [MainThread]: Flushing usage events
[0m16:44:18.963749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063bf9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cf0c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cdec70>]}


============================== 16:44:18.967088 | f29e0fb5-a8d3-4af4-ab34-0fcd28b2f572 ==============================
[0m16:44:18.967088 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:44:18.967426 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m16:44:19.147380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f29e0fb5-a8d3-4af4-ab34-0fcd28b2f572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e84a90>]}
[0m16:44:19.192431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f29e0fb5-a8d3-4af4-ab34-0fcd28b2f572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110e3b20>]}
[0m16:44:19.192796 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:44:19.204709 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m16:44:19.257790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:44:19.258078 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:44:19.262008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f29e0fb5-a8d3-4af4-ab34-0fcd28b2f572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112d3e20>]}
[0m16:44:19.269154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f29e0fb5-a8d3-4af4-ab34-0fcd28b2f572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111ef5e0>]}
[0m16:44:19.269467 [info ] [MainThread]: Found 13 models, 8 sources, 0 exposures, 0 metrics, 423 macros, 0 groups, 0 semantic models
[0m16:44:19.269690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f29e0fb5-a8d3-4af4-ab34-0fcd28b2f572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111ef8b0>]}
[0m16:44:19.270554 [info ] [MainThread]: 
[0m16:44:19.270978 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:44:19.271626 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m16:44:19.281186 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m16:44:19.281466 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m16:44:19.281657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:20.130932 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:44:20.133549 [debug] [ThreadPool]: On list_iceberg: Close
[0m16:44:20.137438 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_landing)
[0m16:44:20.146095 [debug] [ThreadPool]: Using trino connection "list_iceberg_landing"
[0m16:44:20.146492 [debug] [ThreadPool]: On list_iceberg_landing: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg_landing"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'landing') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'landing'
[0m16:44:20.146740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:21.334690 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:44:21.335634 [debug] [ThreadPool]: On list_iceberg_landing: ROLLBACK
[0m16:44:21.335845 [debug] [ThreadPool]: On list_iceberg_landing: Close
[0m16:44:21.336632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f29e0fb5-a8d3-4af4-ab34-0fcd28b2f572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111085370>]}
[0m16:44:21.336917 [debug] [MainThread]: On master: COMMIT
[0m16:44:21.337321 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:44:21.337541 [info ] [MainThread]: 
[0m16:44:21.340615 [debug] [Thread-1  ]: Began running node model.dev.ride_transactions
[0m16:44:21.340969 [info ] [Thread-1  ]: 1 of 1 START sql view model iceberg.landing.ride_transactions .................. [RUN]
[0m16:44:21.341425 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_landing, now model.dev.ride_transactions)
[0m16:44:21.341650 [debug] [Thread-1  ]: Began compiling node model.dev.ride_transactions
[0m16:44:21.344837 [debug] [Thread-1  ]: Writing injected SQL for node "model.dev.ride_transactions"
[0m16:44:21.358470 [debug] [Thread-1  ]: Timing info for model.dev.ride_transactions (compile): 16:44:21.341787 => 16:44:21.358216
[0m16:44:21.358769 [debug] [Thread-1  ]: Began executing node model.dev.ride_transactions
[0m16:44:21.372870 [debug] [Thread-1  ]: Writing runtime sql for node "model.dev.ride_transactions"
[0m16:44:21.393117 [debug] [Thread-1  ]: Using trino connection "model.dev.ride_transactions"
[0m16:44:21.393502 [debug] [Thread-1  ]: On model.dev.ride_transactions: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.ride_transactions"} */

  create or replace view
    "iceberg"."landing"."ride_transactions"
  security definer
  as
    

WITH user AS (

    SELECT
        *
    FROM
        "iceberg"."landing"."users"
),
vehicle AS (
    SELECT
        *
    FROM
        "iceberg"."landing"."postgres_vehicle"
),
subscription AS (
    SELECT
        *
    FROM
        "iceberg"."landing"."postgres_subscription"
),
stripe AS (
    SELECT
        *
    FROM
        "iceberg"."landing"."mongodb_stripe"
),
payment AS (
    SELECT
        *
    FROM
        "iceberg"."landing"."postgres_payments"
)
SELECT
    rides.ride_id AS ride_id,
    rides.user_id AS user_id,
    rides.vehicle_id AS vehicle_id,
    rides.subscription_id AS subscription_id,
    rides.stripe_id AS stripe_id,
    rides.payment_id AS payment_id,
    user.full_name AS user_full_name,
    user.cpf AS user_cpf,
    rides.source AS source,
    rides.destination AS destination,
    rides.estimated_price AS estimated_price,
    rides.surge_multiplier AS dynamic_fare,
    rides.price AS price,
    vehicle.name AS vehicle_name,
    vehicle.year AS vehicle_year,
    vehicle.km_driven AS vehicle_km_driven,
    vehicle.seats AS vehicle_seats,
    subscription.plan AS subscription_plan,
    subscription.status AS subscription_status,
    subscription.payment_method AS subscription_payment_method,
    stripe.identifier AS stripe_identifier,
    stripe.card_type AS stripe_card_type,
    payment.city AS payment_city,
    payment.country AS payment_country,
    payment.currency AS payment_currency,
    payment.credit_card_type AS payment_credit_card_type,
    payment.price AS payment_price
FROM
    "iceberg"."landing"."mongodb_rides" AS rides
    LEFT OUTER JOIN USER AS USER
    ON rides.user_id = USER.user_id
    LEFT OUTER JOIN vehicle AS vehicle
    ON rides.vehicle_id = vehicle.vehicle_id
    LEFT OUTER JOIN subscription AS subscription
    ON rides.subscription_id = subscription.subscription_id
    LEFT OUTER JOIN stripe AS stripe
    ON rides.stripe_id = stripe.stripe_id
    LEFT OUTER JOIN payment AS payment
    ON rides.payment_id = payment.payment_id
  
[0m16:44:21.393774 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:44:22.342176 [debug] [Thread-1  ]: Trino adapter: Trino query id: 20240224_194421_03891_m7mg4
[0m16:44:22.343389 [debug] [Thread-1  ]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 14:9: Table 'iceberg.landing.users' does not exist", query_id=20240224_194421_03891_m7mg4)
[0m16:44:22.344357 [debug] [Thread-1  ]: Timing info for model.dev.ride_transactions (execute): 16:44:21.358921 => 16:44:22.344003
[0m16:44:22.344945 [debug] [Thread-1  ]: On model.dev.ride_transactions: ROLLBACK
[0m16:44:22.345440 [debug] [Thread-1  ]: On model.dev.ride_transactions: Close
[0m16:44:22.411595 [debug] [Thread-1  ]: Database Error in model ride_transactions (models/trusted/ride_transactions.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 14:9: Table 'iceberg.landing.users' does not exist", query_id=20240224_194421_03891_m7mg4)
  compiled Code at target/run/dev/models/trusted/ride_transactions.sql
[0m16:44:22.412608 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f29e0fb5-a8d3-4af4-ab34-0fcd28b2f572', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113885b0>]}
[0m16:44:22.413329 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model iceberg.landing.ride_transactions ......... [[31mERROR[0m in 1.07s]
[0m16:44:22.413954 [debug] [Thread-1  ]: Finished running node model.dev.ride_transactions
[0m16:44:22.415479 [debug] [MainThread]: On master: COMMIT
[0m16:44:22.416172 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:22.416422 [debug] [MainThread]: Connection 'model.dev.ride_transactions' was properly closed.
[0m16:44:22.416715 [info ] [MainThread]: 
[0m16:44:22.417016 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.15 seconds (3.15s).
[0m16:44:22.417691 [debug] [MainThread]: Command end result
[0m16:44:22.428515 [info ] [MainThread]: 
[0m16:44:22.428963 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:44:22.429190 [info ] [MainThread]: 
[0m16:44:22.429434 [error] [MainThread]:   Database Error in model ride_transactions (models/trusted/ride_transactions.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 14:9: Table 'iceberg.landing.users' does not exist", query_id=20240224_194421_03891_m7mg4)
  compiled Code at target/run/dev/models/trusted/ride_transactions.sql
[0m16:44:22.429663 [info ] [MainThread]: 
[0m16:44:22.429923 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:44:22.433119 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.5099716, "process_user_time": 1.625233, "process_kernel_time": 0.233385, "process_mem_max_rss": "120881152", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:44:22.433575 [debug] [MainThread]: Command `cli run` failed at 16:44:22.433493 after 3.51 seconds
[0m16:44:22.433864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063bf9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f1a370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e84a90>]}
[0m16:44:22.434310 [debug] [MainThread]: Flushing usage events
[0m16:44:30.262279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c477cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128f51310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128f9b280>]}


============================== 16:44:30.265458 | c14ce6f0-e299-4cf4-be46-e5daebef7eca ==============================
[0m16:44:30.265458 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:44:30.265796 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:44:30.444982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c14ce6f0-e299-4cf4-be46-e5daebef7eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128f51310>]}
[0m16:44:30.491645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c14ce6f0-e299-4cf4-be46-e5daebef7eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1290ed280>]}
[0m16:44:30.492002 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:44:30.504705 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m16:44:30.555966 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:44:30.556256 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:44:30.560056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c14ce6f0-e299-4cf4-be46-e5daebef7eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129593df0>]}
[0m16:44:30.575140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c14ce6f0-e299-4cf4-be46-e5daebef7eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1293b05b0>]}
[0m16:44:30.575565 [info ] [MainThread]: Found 13 models, 8 sources, 0 exposures, 0 metrics, 423 macros, 0 groups, 0 semantic models
[0m16:44:30.575824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c14ce6f0-e299-4cf4-be46-e5daebef7eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1293b0880>]}
[0m16:44:30.576828 [info ] [MainThread]: 
[0m16:44:30.577346 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:44:30.577998 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m16:44:30.588608 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m16:44:30.588920 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m16:44:30.589115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:31.431281 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:44:31.432206 [debug] [ThreadPool]: On list_iceberg: Close
[0m16:44:31.433702 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_landing)
[0m16:44:31.438611 [debug] [ThreadPool]: Using trino connection "list_iceberg_landing"
[0m16:44:31.438883 [debug] [ThreadPool]: On list_iceberg_landing: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg_landing"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'landing') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'landing'
[0m16:44:31.439065 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:32.598445 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:44:32.599315 [debug] [ThreadPool]: On list_iceberg_landing: ROLLBACK
[0m16:44:32.599509 [debug] [ThreadPool]: On list_iceberg_landing: Close
[0m16:44:32.600315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c14ce6f0-e299-4cf4-be46-e5daebef7eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129557d90>]}
[0m16:44:32.600592 [debug] [MainThread]: On master: COMMIT
[0m16:44:32.600952 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:44:32.601151 [info ] [MainThread]: 
[0m16:44:32.602654 [debug] [Thread-1  ]: Began running node model.dev.mongodb_rides
[0m16:44:32.602994 [info ] [Thread-1  ]: 1 of 1 START sql table model iceberg.landing.mongodb_rides ..................... [RUN]
[0m16:44:32.603420 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_landing, now model.dev.mongodb_rides)
[0m16:44:32.603642 [debug] [Thread-1  ]: Began compiling node model.dev.mongodb_rides
[0m16:44:32.606675 [debug] [Thread-1  ]: Writing injected SQL for node "model.dev.mongodb_rides"
[0m16:44:32.607474 [debug] [Thread-1  ]: Timing info for model.dev.mongodb_rides (compile): 16:44:32.603793 => 16:44:32.607289
[0m16:44:32.607708 [debug] [Thread-1  ]: Began executing node model.dev.mongodb_rides
[0m16:44:32.629202 [debug] [Thread-1  ]: Writing runtime sql for node "model.dev.mongodb_rides"
[0m16:44:32.632043 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_rides"
[0m16:44:32.632306 [debug] [Thread-1  ]: On model.dev.mongodb_rides: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_rides"} */

  
    

    create table "iceberg"."landing"."mongodb_rides__dbt_tmp"
      
      
    as (
      

SELECT
    
    CAST(FLOOR(random() * (10000 - 1 + 1)) + 1 AS INTEGER)
 AS ride_id,
    CAST(
        user_id AS INT
    ) AS user_id,
    cpf AS cpf,
    CAST(
        vehicle_id AS INT
    ) AS vehicle_id,
    
    CAST(FLOOR(random() * (10000 - 1 + 1)) + 1 AS INTEGER)
 AS subscription_id,
    
    CAST(FLOOR(random() * (10000 - 1 + 1)) + 1 AS INTEGER)
 AS payment_id,
    
    CAST(FLOOR(random() * (10000 - 1 + 1)) + 1 AS INTEGER)
 AS stripe_id,
    source AS source,
    destination AS destination,
    CAST(
        price AS REAL
    ) AS estimated_price,
    surge_multiplier AS surge_multiplier,
    CASE
        WHEN surge_multiplier <> 1 THEN CAST(
            price AS REAL
        ) * surge_multiplier
        ELSE CAST(
            price AS REAL
        )
    END AS price,
    NAME AS car_type,
    cab_type AS service_type,
    CAST(
        dt_current_timestamp AS TIMESTAMP
    ) AS last_updated
FROM
    "minio"."landing"."mongodb_rides_parquet"
    )
[0m16:44:32.632528 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:44:56.203273 [debug] [Thread-1  ]: SQL status: SUCCESS in 24.0 seconds
[0m16:44:56.207817 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_rides"
[0m16:44:56.208087 [debug] [Thread-1  ]: On model.dev.mongodb_rides: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_rides"} */
alter table "iceberg"."landing"."mongodb_rides__dbt_tmp" rename to "iceberg"."landing"."mongodb_rides"
[0m16:44:57.688365 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:44:57.696092 [debug] [Thread-1  ]: Applying DROP to: "iceberg"."landing"."mongodb_rides__dbt_backup"
[0m16:44:57.697554 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_rides"
[0m16:44:57.697814 [debug] [Thread-1  ]: On model.dev.mongodb_rides: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_rides"} */

    drop table if exists "iceberg"."landing"."mongodb_rides__dbt_backup"
[0m16:44:58.248900 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:44:58.262560 [debug] [Thread-1  ]: Timing info for model.dev.mongodb_rides (execute): 16:44:32.607834 => 16:44:58.262398
[0m16:44:58.262880 [debug] [Thread-1  ]: On model.dev.mongodb_rides: ROLLBACK
[0m16:44:58.263097 [debug] [Thread-1  ]: On model.dev.mongodb_rides: Close
[0m16:44:58.263827 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c14ce6f0-e299-4cf4-be46-e5daebef7eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1297790d0>]}
[0m16:44:58.264260 [info ] [Thread-1  ]: 1 of 1 OK created sql table model iceberg.landing.mongodb_rides ................ [[32mSUCCESS[0m in 25.66s]
[0m16:44:58.264623 [debug] [Thread-1  ]: Finished running node model.dev.mongodb_rides
[0m16:44:58.265624 [debug] [MainThread]: On master: COMMIT
[0m16:44:58.266072 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:58.266279 [debug] [MainThread]: Connection 'model.dev.mongodb_rides' was properly closed.
[0m16:44:58.266502 [info ] [MainThread]: 
[0m16:44:58.266760 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 27.69 seconds (27.69s).
[0m16:44:58.267208 [debug] [MainThread]: Command end result
[0m16:44:58.276278 [info ] [MainThread]: 
[0m16:44:58.276602 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:44:58.276813 [info ] [MainThread]: 
[0m16:44:58.277091 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:44:58.279929 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 28.061283, "process_user_time": 1.61496, "process_kernel_time": 0.232172, "process_mem_max_rss": "119504896", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:44:58.280406 [debug] [MainThread]: Command `cli run` succeeded at 16:44:58.280308 after 28.06 seconds
[0m16:44:58.280698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c477cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1297d2280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1297790d0>]}
[0m16:44:58.281242 [debug] [MainThread]: Flushing usage events
[0m16:45:01.063761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bef400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a2cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a1ac70>]}


============================== 16:45:01.067185 | 4a48718c-4e5e-438d-871e-a892aa8bb47d ==============================
[0m16:45:01.067185 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:45:01.067515 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:45:01.234622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a48718c-4e5e-438d-871e-a892aa8bb47d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d4fa30>]}
[0m16:45:01.279807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a48718c-4e5e-438d-871e-a892aa8bb47d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b63d00>]}
[0m16:45:01.280182 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:45:01.291975 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m16:45:01.345350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:45:01.345653 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:45:01.349474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a48718c-4e5e-438d-871e-a892aa8bb47d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f0fe20>]}
[0m16:45:01.356771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a48718c-4e5e-438d-871e-a892aa8bb47d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e2b5e0>]}
[0m16:45:01.357166 [info ] [MainThread]: Found 13 models, 8 sources, 0 exposures, 0 metrics, 423 macros, 0 groups, 0 semantic models
[0m16:45:01.357391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a48718c-4e5e-438d-871e-a892aa8bb47d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e2b8b0>]}
[0m16:45:01.358345 [info ] [MainThread]: 
[0m16:45:01.358814 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:45:01.359462 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m16:45:01.369280 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m16:45:01.369500 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m16:45:01.369669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:02.350619 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:45:02.354137 [debug] [ThreadPool]: On list_iceberg: Close
[0m16:45:02.358436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_landing)
[0m16:45:02.366456 [debug] [ThreadPool]: Using trino connection "list_iceberg_landing"
[0m16:45:02.366901 [debug] [ThreadPool]: On list_iceberg_landing: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg_landing"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'landing') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'landing'
[0m16:45:02.367160 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:45:03.930588 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m16:45:03.933851 [debug] [ThreadPool]: On list_iceberg_landing: ROLLBACK
[0m16:45:03.934683 [debug] [ThreadPool]: On list_iceberg_landing: Close
[0m16:45:03.937236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a48718c-4e5e-438d-871e-a892aa8bb47d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cc76a0>]}
[0m16:45:03.938235 [debug] [MainThread]: On master: COMMIT
[0m16:45:03.938948 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:45:03.939240 [info ] [MainThread]: 
[0m16:45:03.943384 [debug] [Thread-1  ]: Began running node model.dev.mongodb_stripe
[0m16:45:03.943952 [info ] [Thread-1  ]: 1 of 1 START sql table model iceberg.landing.mongodb_stripe .................... [RUN]
[0m16:45:03.944533 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_landing, now model.dev.mongodb_stripe)
[0m16:45:03.944827 [debug] [Thread-1  ]: Began compiling node model.dev.mongodb_stripe
[0m16:45:03.947952 [debug] [Thread-1  ]: Writing injected SQL for node "model.dev.mongodb_stripe"
[0m16:45:03.949147 [debug] [Thread-1  ]: Timing info for model.dev.mongodb_stripe (compile): 16:45:03.944988 => 16:45:03.948975
[0m16:45:03.949422 [debug] [Thread-1  ]: Began executing node model.dev.mongodb_stripe
[0m16:45:03.981263 [debug] [Thread-1  ]: Writing runtime sql for node "model.dev.mongodb_stripe"
[0m16:45:03.983529 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_stripe"
[0m16:45:03.983941 [debug] [Thread-1  ]: On model.dev.mongodb_stripe: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_stripe"} */

  
    

    create table "iceberg"."landing"."mongodb_stripe__dbt_tmp"
      
      
    as (
      

SELECT
    DISTINCT CAST(
        id AS INT
    ) AS stripe_id,
    UID AS identifier,
    token AS card_type,
    ccv AS card_ccv,
    CAST(
        dt_current_timestamp AS TIMESTAMP
    ) AS last_updated
FROM
    "minio"."landing"."mongodb_stripe_parquet"
    )
[0m16:45:03.984203 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:45:39.679890 [debug] [Thread-1  ]: SQL status: SUCCESS in 36.0 seconds
[0m16:45:39.684214 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_stripe"
[0m16:45:39.684446 [debug] [Thread-1  ]: On model.dev.mongodb_stripe: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_stripe"} */
alter table "iceberg"."landing"."mongodb_stripe__dbt_tmp" rename to "iceberg"."landing"."mongodb_stripe"
[0m16:45:41.031505 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:45:41.047936 [debug] [Thread-1  ]: Applying DROP to: "iceberg"."landing"."mongodb_stripe__dbt_backup"
[0m16:45:41.052576 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_stripe"
[0m16:45:41.053427 [debug] [Thread-1  ]: On model.dev.mongodb_stripe: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_stripe"} */

    drop table if exists "iceberg"."landing"."mongodb_stripe__dbt_backup"
[0m16:45:41.632820 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:45:41.663130 [debug] [Thread-1  ]: Timing info for model.dev.mongodb_stripe (execute): 16:45:03.949569 => 16:45:41.662928
[0m16:45:41.663554 [debug] [Thread-1  ]: On model.dev.mongodb_stripe: ROLLBACK
[0m16:45:41.664048 [debug] [Thread-1  ]: On model.dev.mongodb_stripe: Close
[0m16:45:41.664934 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a48718c-4e5e-438d-871e-a892aa8bb47d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11203c940>]}
[0m16:45:41.665430 [info ] [Thread-1  ]: 1 of 1 OK created sql table model iceberg.landing.mongodb_stripe ............... [[32mSUCCESS[0m in 37.72s]
[0m16:45:41.665869 [debug] [Thread-1  ]: Finished running node model.dev.mongodb_stripe
[0m16:45:41.666838 [debug] [MainThread]: On master: COMMIT
[0m16:45:41.667253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:45:41.667447 [debug] [MainThread]: Connection 'model.dev.mongodb_stripe' was properly closed.
[0m16:45:41.667669 [info ] [MainThread]: 
[0m16:45:41.668011 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 40.31 seconds (40.31s).
[0m16:45:41.668690 [debug] [MainThread]: Command end result
[0m16:45:41.680344 [info ] [MainThread]: 
[0m16:45:41.680830 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:45:41.681072 [info ] [MainThread]: 
[0m16:45:41.681335 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:45:41.683912 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 40.660236, "process_user_time": 1.654537, "process_kernel_time": 0.230852, "process_mem_max_rss": "120717312", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:45:41.684482 [debug] [MainThread]: Command `cli run` succeeded at 16:45:41.684381 after 40.66 seconds
[0m16:45:41.684938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bef400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f857c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b5fb20>]}
[0m16:45:41.685250 [debug] [MainThread]: Flushing usage events
[0m16:45:44.507572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037372e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10716cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715a9d0>]}


============================== 16:45:44.510462 | 894d5223-5f63-4d90-b8e2-c7c9a170cc3a ==============================
[0m16:45:44.510462 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:45:44.510788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m16:45:44.688179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '894d5223-5f63-4d90-b8e2-c7c9a170cc3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10716cac0>]}
[0m16:45:44.733103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '894d5223-5f63-4d90-b8e2-c7c9a170cc3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10726d520>]}
[0m16:45:44.733490 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:45:44.746199 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m16:45:44.805619 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:45:44.805930 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:45:44.809782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '894d5223-5f63-4d90-b8e2-c7c9a170cc3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10764fd60>]}
[0m16:45:44.816658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '894d5223-5f63-4d90-b8e2-c7c9a170cc3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107570580>]}
[0m16:45:44.816960 [info ] [MainThread]: Found 13 models, 8 sources, 0 exposures, 0 metrics, 423 macros, 0 groups, 0 semantic models
[0m16:45:44.817190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '894d5223-5f63-4d90-b8e2-c7c9a170cc3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107570760>]}
[0m16:45:44.818039 [info ] [MainThread]: 
[0m16:45:44.818478 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:45:44.819060 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m16:45:44.828614 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m16:45:44.828862 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m16:45:44.829061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:45.817442 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:45:45.822461 [debug] [ThreadPool]: On list_iceberg: Close
[0m16:45:45.828751 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_landing)
[0m16:45:45.845120 [debug] [ThreadPool]: Using trino connection "list_iceberg_landing"
[0m16:45:45.846246 [debug] [ThreadPool]: On list_iceberg_landing: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg_landing"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'landing') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'landing'
[0m16:45:45.846896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:45:47.222728 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:45:47.226294 [debug] [ThreadPool]: On list_iceberg_landing: ROLLBACK
[0m16:45:47.226849 [debug] [ThreadPool]: On list_iceberg_landing: Close
[0m16:45:47.230018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '894d5223-5f63-4d90-b8e2-c7c9a170cc3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073fd190>]}
[0m16:45:47.231423 [debug] [MainThread]: On master: COMMIT
[0m16:45:47.233492 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:45:47.234417 [info ] [MainThread]: 
[0m16:45:47.239587 [debug] [Thread-1  ]: Began running node model.dev.mongodb_users
[0m16:45:47.240800 [info ] [Thread-1  ]: 1 of 1 START sql table model iceberg.landing.mongodb_users ..................... [RUN]
[0m16:45:47.242417 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_landing, now model.dev.mongodb_users)
[0m16:45:47.243347 [debug] [Thread-1  ]: Began compiling node model.dev.mongodb_users
[0m16:45:47.254470 [debug] [Thread-1  ]: Writing injected SQL for node "model.dev.mongodb_users"
[0m16:45:47.256939 [debug] [Thread-1  ]: Timing info for model.dev.mongodb_users (compile): 16:45:47.243859 => 16:45:47.256427
[0m16:45:47.257667 [debug] [Thread-1  ]: Began executing node model.dev.mongodb_users
[0m16:45:47.290820 [debug] [Thread-1  ]: Writing runtime sql for node "model.dev.mongodb_users"
[0m16:45:47.293741 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_users"
[0m16:45:47.294055 [debug] [Thread-1  ]: On model.dev.mongodb_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_users"} */

  
    

    create table "iceberg"."landing"."mongodb_users__dbt_tmp"
      
      
    as (
      

SELECT
    DISTINCT CAST(
        id AS INT
    ) AS id,
    CAST(
        user_id AS INT
    ) AS user_id,
    cpf AS cpf,
    CONCAT(
        first_name,
        ' ',
        last_name
    ) AS full_name,
    
    CASE
        WHEN email IS NULL THEN NULL
        ELSE CONCAT(SUBSTRING(email, 1, 1), '*****', SUBSTRING(email, strpos(email, '@')))
    END
 AS email,
    gender AS gender,
    phone_number AS phone_number,
    
    CONCAT('xxx-xx-', SUBSTRING(social_insurance_number, 8, 4))
 AS social_security_number,
    date_of_birth AS date_of_birth,
    CAST(
        dt_current_timestamp AS TIMESTAMP
    ) AS last_updated
FROM
    "minio"."landing"."mongodb_users_parquet"
    )
[0m16:45:47.294309 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:46:36.916328 [debug] [Thread-1  ]: SQL status: SUCCESS in 50.0 seconds
[0m16:46:36.930001 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_users"
[0m16:46:36.930495 [debug] [Thread-1  ]: On model.dev.mongodb_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_users"} */
alter table "iceberg"."landing"."mongodb_users__dbt_tmp" rename to "iceberg"."landing"."mongodb_users"
[0m16:46:38.335015 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:46:38.347906 [debug] [Thread-1  ]: Applying DROP to: "iceberg"."landing"."mongodb_users__dbt_backup"
[0m16:46:38.349660 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_users"
[0m16:46:38.349952 [debug] [Thread-1  ]: On model.dev.mongodb_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_users"} */

    drop table if exists "iceberg"."landing"."mongodb_users__dbt_backup"
[0m16:46:38.910501 [debug] [Thread-1  ]: SQL status: SUCCESS in 1.0 seconds
[0m16:46:38.929567 [debug] [Thread-1  ]: Timing info for model.dev.mongodb_users (execute): 16:45:47.258287 => 16:46:38.929349
[0m16:46:38.930096 [debug] [Thread-1  ]: On model.dev.mongodb_users: ROLLBACK
[0m16:46:38.930375 [debug] [Thread-1  ]: On model.dev.mongodb_users: Close
[0m16:46:38.931317 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '894d5223-5f63-4d90-b8e2-c7c9a170cc3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10780bf10>]}
[0m16:46:38.931858 [info ] [Thread-1  ]: 1 of 1 OK created sql table model iceberg.landing.mongodb_users ................ [[32mSUCCESS[0m in 51.69s]
[0m16:46:38.932318 [debug] [Thread-1  ]: Finished running node model.dev.mongodb_users
[0m16:46:38.933578 [debug] [MainThread]: On master: COMMIT
[0m16:46:38.934100 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:46:38.934345 [debug] [MainThread]: Connection 'model.dev.mongodb_users' was properly closed.
[0m16:46:38.934598 [info ] [MainThread]: 
[0m16:46:38.934880 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 54.12 seconds (54.12s).
[0m16:46:38.935407 [debug] [MainThread]: Command end result
[0m16:46:38.946664 [info ] [MainThread]: 
[0m16:46:38.947067 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:46:38.947306 [info ] [MainThread]: 
[0m16:46:38.947581 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:46:38.950121 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 54.477646, "process_user_time": 1.728631, "process_kernel_time": 0.241025, "process_mem_max_rss": "122437632", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:46:38.950614 [debug] [MainThread]: Command `cli run` succeeded at 16:46:38.950521 after 54.48 seconds
[0m16:46:38.950966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037372e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a1e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10739e250>]}
[0m16:46:38.951281 [debug] [MainThread]: Flushing usage events
[0m16:46:41.758280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063276d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f70c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f5f190>]}


============================== 16:46:41.761410 | 880207d8-5d0f-47dd-849a-22f1b8e94ca2 ==============================
[0m16:46:41.761410 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:46:41.761753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq/logs', 'debug': 'False', 'profiles_dir': '/Users/luanmorenomaciel/GitHub/ws-stack-dados-k8s/data/dags/dbt/owshq', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:46:41.935605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '880207d8-5d0f-47dd-849a-22f1b8e94ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f5f790>]}
[0m16:46:41.984893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '880207d8-5d0f-47dd-849a-22f1b8e94ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f15e50>]}
[0m16:46:41.985341 [info ] [MainThread]: Registered adapter: trino=1.7.0
[0m16:46:41.999474 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m16:46:42.058080 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:46:42.058428 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:46:42.061975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '880207d8-5d0f-47dd-849a-22f1b8e94ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a653e50>]}
[0m16:46:42.069207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '880207d8-5d0f-47dd-849a-22f1b8e94ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a574670>]}
[0m16:46:42.069634 [info ] [MainThread]: Found 13 models, 8 sources, 0 exposures, 0 metrics, 423 macros, 0 groups, 0 semantic models
[0m16:46:42.069865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '880207d8-5d0f-47dd-849a-22f1b8e94ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a574850>]}
[0m16:46:42.070803 [info ] [MainThread]: 
[0m16:46:42.071300 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:46:42.071986 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m16:46:42.082556 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m16:46:42.082772 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m16:46:42.082943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:42.812083 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:46:42.813321 [debug] [ThreadPool]: On list_iceberg: Close
[0m16:46:42.815773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_landing)
[0m16:46:42.821786 [debug] [ThreadPool]: Using trino connection "list_iceberg_landing"
[0m16:46:42.822144 [debug] [ThreadPool]: On list_iceberg_landing: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "connection_name": "list_iceberg_landing"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'landing') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'landing'
[0m16:46:42.822367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:46:44.072122 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:46:44.074338 [debug] [ThreadPool]: On list_iceberg_landing: ROLLBACK
[0m16:46:44.074967 [debug] [ThreadPool]: On list_iceberg_landing: Close
[0m16:46:44.077509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '880207d8-5d0f-47dd-849a-22f1b8e94ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10149deb0>]}
[0m16:46:44.078266 [debug] [MainThread]: On master: COMMIT
[0m16:46:44.079302 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:46:44.080131 [info ] [MainThread]: 
[0m16:46:44.084019 [debug] [Thread-1  ]: Began running node model.dev.mongodb_users
[0m16:46:44.084677 [info ] [Thread-1  ]: 1 of 1 START sql table model iceberg.landing.mongodb_users ..................... [RUN]
[0m16:46:44.085445 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_landing, now model.dev.mongodb_users)
[0m16:46:44.085713 [debug] [Thread-1  ]: Began compiling node model.dev.mongodb_users
[0m16:46:44.089088 [debug] [Thread-1  ]: Writing injected SQL for node "model.dev.mongodb_users"
[0m16:46:44.090615 [debug] [Thread-1  ]: Timing info for model.dev.mongodb_users (compile): 16:46:44.085853 => 16:46:44.090388
[0m16:46:44.090896 [debug] [Thread-1  ]: Began executing node model.dev.mongodb_users
[0m16:46:44.116469 [debug] [Thread-1  ]: Writing runtime sql for node "model.dev.mongodb_users"
[0m16:46:44.119525 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_users"
[0m16:46:44.119809 [debug] [Thread-1  ]: On model.dev.mongodb_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_users"} */

  
    

    create table "iceberg"."landing"."mongodb_users__dbt_tmp"
      
      
    as (
      

SELECT
    DISTINCT CAST(
        id AS INT
    ) AS id,
    CAST(
        user_id AS INT
    ) AS user_id,
    cpf AS cpf,
    CONCAT(
        first_name,
        ' ',
        last_name
    ) AS full_name,
    
    CASE
        WHEN email IS NULL THEN NULL
        ELSE CONCAT(SUBSTRING(email, 1, 1), '*****', SUBSTRING(email, strpos(email, '@')))
    END
 AS email,
    gender AS gender,
    phone_number AS phone_number,
    
    CONCAT('xxx-xx-', SUBSTRING(social_insurance_number, 8, 4))
 AS social_security_number,
    date_of_birth AS date_of_birth,
    CAST(
        dt_current_timestamp AS TIMESTAMP
    ) AS last_updated
FROM
    "minio"."landing"."mongodb_users_parquet"
    )
[0m16:46:44.120037 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:47:13.148987 [debug] [Thread-1  ]: SQL status: SUCCESS in 29.0 seconds
[0m16:47:13.163046 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_users"
[0m16:47:13.163639 [debug] [Thread-1  ]: On model.dev.mongodb_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_users"} */
alter table "iceberg"."landing"."mongodb_users" rename to "iceberg"."landing"."mongodb_users__dbt_backup"
[0m16:47:14.716608 [debug] [Thread-1  ]: SQL status: SUCCESS in 2.0 seconds
[0m16:47:14.720107 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_users"
[0m16:47:14.720465 [debug] [Thread-1  ]: On model.dev.mongodb_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_users"} */
alter table "iceberg"."landing"."mongodb_users__dbt_tmp" rename to "iceberg"."landing"."mongodb_users"
[0m16:47:16.268950 [debug] [Thread-1  ]: SQL status: SUCCESS in 2.0 seconds
[0m16:47:16.275414 [debug] [Thread-1  ]: Applying DROP to: "iceberg"."landing"."mongodb_users__dbt_backup"
[0m16:47:16.277249 [debug] [Thread-1  ]: Using trino connection "model.dev.mongodb_users"
[0m16:47:16.277566 [debug] [Thread-1  ]: On model.dev.mongodb_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "minio", "target_name": "dev", "node_id": "model.dev.mongodb_users"} */

    drop table if exists "iceberg"."landing"."mongodb_users__dbt_backup"
[0m16:47:18.065230 [debug] [Thread-1  ]: SQL status: SUCCESS in 2.0 seconds
[0m16:47:18.074691 [debug] [Thread-1  ]: Timing info for model.dev.mongodb_users (execute): 16:46:44.091029 => 16:47:18.074543
[0m16:47:18.074996 [debug] [Thread-1  ]: On model.dev.mongodb_users: ROLLBACK
[0m16:47:18.075207 [debug] [Thread-1  ]: On model.dev.mongodb_users: Close
[0m16:47:18.075821 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '880207d8-5d0f-47dd-849a-22f1b8e94ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a70bc10>]}
[0m16:47:18.076239 [info ] [Thread-1  ]: 1 of 1 OK created sql table model iceberg.landing.mongodb_users ................ [[32mSUCCESS[0m in 33.99s]
[0m16:47:18.076646 [debug] [Thread-1  ]: Finished running node model.dev.mongodb_users
[0m16:47:18.077403 [debug] [MainThread]: On master: COMMIT
[0m16:47:18.077724 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:18.077894 [debug] [MainThread]: Connection 'model.dev.mongodb_users' was properly closed.
[0m16:47:18.078066 [info ] [MainThread]: 
[0m16:47:18.078261 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 36.01 seconds (36.01s).
[0m16:47:18.078598 [debug] [MainThread]: Command end result
[0m16:47:18.084413 [info ] [MainThread]: 
[0m16:47:18.084666 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:47:18.084855 [info ] [MainThread]: 
[0m16:47:18.085071 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:47:18.087000 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 36.372143, "process_user_time": 1.651118, "process_kernel_time": 0.232054, "process_mem_max_rss": "122290176", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:47:18.087356 [debug] [MainThread]: Command `cli run` succeeded at 16:47:18.087282 after 36.37 seconds
[0m16:47:18.087579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063276d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a676f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a70bc10>]}
[0m16:47:18.087791 [debug] [MainThread]: Flushing usage events
